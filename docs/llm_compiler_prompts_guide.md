# LLM Compiler æ¶æ„æç¤ºè¯æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº† LLM Compiler æ¶æ„å„ä¸ªé˜¶æ®µçš„æç¤ºè¯è®¾è®¡ï¼ŒåŒ…æ‹¬è®¾è®¡ç†å¿µã€ä½¿ç”¨åœºæ™¯å’Œæœ€ä½³å®è·µã€‚

**ç”Ÿæˆæ—¶é—´**: 2025-11-13  
**æ¶æ„ç‰ˆæœ¬**: LLM Compiler v1.0  
**é€‚ç”¨åœºæ™¯**: å®‰å…¨æ¸—é€æµ‹è¯•ã€è‡ªåŠ¨åŒ–æ‰«æã€å¹¶è¡Œä»»åŠ¡æ‰§è¡Œ

---

## ğŸ—ï¸ LLM Compiler æ¶æ„ç®€ä»‹

LLM Compiler æ˜¯ä¸€ä¸ªåŸºäº DAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰çš„å¹¶è¡Œæ‰§è¡Œæ¶æ„ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š

- âœ… **é«˜å¹¶è¡Œåº¦**: è‡ªåŠ¨è¯†åˆ«å¯å¹¶è¡Œä»»åŠ¡ï¼Œæœ€å¤§åŒ–æ‰§è¡Œæ•ˆç‡
- âœ… **æ™ºèƒ½è°ƒåº¦**: åŸºäºä¾èµ–å…³ç³»åŠ¨æ€è°ƒåº¦ä»»åŠ¡æ‰§è¡Œ
- âœ… **æ•°æ®æµä¼˜åŒ–**: é€šè¿‡å˜é‡å¼•ç”¨å®ç°ä»»åŠ¡é—´é«˜æ•ˆæ•°æ®ä¼ é€’
- âœ… **é”™è¯¯å®¹å¿**: å•ä¸ªä»»åŠ¡å¤±è´¥ä¸å½±å“ç‹¬ç«‹ä»»åŠ¡æ‰§è¡Œ
- âœ… **åŠ¨æ€è°ƒæ•´**: æ”¯æŒè¿è¡Œæ—¶é‡è§„åˆ’å’Œç­–ç•¥è°ƒæ•´

### æ‰§è¡Œæµç¨‹

```mermaid
graph LR
    A[ç”¨æˆ·ä»»åŠ¡] --> B[Planning<br/>è§„åˆ’é˜¶æ®µ]
    B --> C[Task Fetching<br/>ä»»åŠ¡è°ƒåº¦]
    C --> D[Parallel Execution<br/>å¹¶è¡Œæ‰§è¡Œ]
    D --> E[Evaluation<br/>è¯„ä¼°å†³ç­–]
    E -->|ç»§ç»­| F[Replanning<br/>é‡è§„åˆ’]
    E -->|å®Œæˆ| G[Final Response<br/>æœ€ç»ˆå“åº”]
    F --> C
```

---

## ğŸ“ å„é˜¶æ®µæç¤ºè¯è¯¦è§£

### 1ï¸âƒ£ Planning é˜¶æ®µ - è§„åˆ’å™¨

**èŒè´£**: å°†ç”¨æˆ·å¤æ‚ä»»åŠ¡æ‹†è§£ä¸ºå¯å¹¶è¡Œæ‰§è¡Œçš„ DAG è®¡åˆ’

**è¾“å…¥**:
- ç”¨æˆ·åŸå§‹ä»»åŠ¡æè¿°
- å¯ç”¨å·¥å…·åˆ—è¡¨åŠå…¶ Schema
- æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆå¯é€‰ï¼‰

**è¾“å‡º**: å®Œæ•´çš„ DAG JSON è®¡åˆ’

**è®¾è®¡è¦ç‚¹**:

#### æ ¸å¿ƒåŸåˆ™
1. **æœ€å¤§åŒ–å¹¶è¡Œåº¦**: è¯†åˆ«æ‰€æœ‰å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ä»»åŠ¡
2. **æœ€å°åŒ–ä¾èµ–**: åªåœ¨å¿…è¦æ—¶å»ºç«‹ä»»åŠ¡ä¾èµ–å…³ç³»
3. **ä¼˜åŒ–æ•°æ®æµ**: ä½¿ç”¨å˜é‡å¼•ç”¨é¿å…æ•°æ®é‡å¤ä¼ é€’

#### å®‰å…¨æµ‹è¯•ä¼˜åŒ–
- **ç«¯å£æ‰«æ**: å¤šç›®æ ‡å¯å¹¶è¡Œæ‰«æ
- **å­åŸŸåæšä¸¾**: åˆ†æ•£åˆ°ä¸åŒ DNS æœåŠ¡å™¨
- **æ¼æ´æ‰«æ**: ä¾èµ–äºç«¯å£å¼€æ”¾ç¡®è®¤
- **ä¿¡æ¯æ”¶é›†**: ä¼˜å…ˆçº§é«˜äºæ·±åº¦åˆ©ç”¨

#### ä¼˜å…ˆçº§åˆ†é…ç­–ç•¥

| ä»»åŠ¡ç±»å‹ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|---------|--------|------|
| ä¿¡æ¯æ”¶é›† | 1-2 | æœ€é«˜ä¼˜å…ˆçº§ï¼Œä¸ºåç»­ä»»åŠ¡æä¾›åŸºç¡€ |
| ç«¯å£/æœåŠ¡æ¢æµ‹ | 2-3 | é«˜ä¼˜å…ˆçº§ï¼Œç¡®å®šæ”»å‡»é¢ |
| æ¼æ´æ‰«æ | 4-5 | ä¸­ç­‰ä¼˜å…ˆçº§ |
| æ·±åº¦åˆ†æ | 6-7 | è¾ƒä½ä¼˜å…ˆçº§ |
| æ¼æ´åˆ©ç”¨ | 8-9 | ä½ä¼˜å…ˆçº§ï¼Œéœ€è°¨æ…æ‰§è¡Œ |
| æŠ¥å‘Šç”Ÿæˆ | 10 | æœ€ä½ä¼˜å…ˆçº§ |

#### å¸¸è§ DAG æ¨¡å¼

**æ¨¡å¼1: å¹¶è¡Œæ‰«æ**ï¼ˆæ— ä¾èµ–ï¼‰
```json
{
  "nodes": [
    {"task_id": "scan_1", "tool_name": "port_scan", "arguments": {"target": "192.168.1.1"}},
    {"task_id": "scan_2", "tool_name": "port_scan", "arguments": {"target": "192.168.1.2"}},
    {"task_id": "scan_3", "tool_name": "port_scan", "arguments": {"target": "192.168.1.3"}}
  ],
  "dependency_graph": {
    "scan_1": [],
    "scan_2": [],
    "scan_3": []
  },
  "parallelism_degree": 3
}
```

**æ¨¡å¼2: ä¸²è¡Œä¾èµ–**ï¼ˆå…ˆå‘ç°ååˆ©ç”¨ï¼‰
```json
{
  "nodes": [
    {"task_id": "discover", "tool_name": "vuln_scan", "dependencies": []},
    {"task_id": "exploit", "tool_name": "exploit_tool", "arguments": {"vuln": "$discover"}, "dependencies": ["discover"]}
  ],
  "dependency_graph": {
    "discover": [],
    "exploit": ["discover"]
  }
}
```

**æ¨¡å¼3: æ‰‡å‡ºæ¨¡å¼**ï¼ˆä¸€å¯¹å¤šï¼‰
```json
{
  "nodes": [
    {"task_id": "enum", "tool_name": "subdomain_enum", "dependencies": []},
    {"task_id": "check_1", "tool_name": "http_probe", "arguments": {"domain": "$enum.sub1"}, "dependencies": ["enum"]},
    {"task_id": "check_2", "tool_name": "http_probe", "arguments": {"domain": "$enum.sub2"}, "dependencies": ["enum"]},
    {"task_id": "check_3", "tool_name": "http_probe", "arguments": {"domain": "$enum.sub3"}, "dependencies": ["enum"]}
  ]
}
```

**æ¨¡å¼4: æ±‡èšæ¨¡å¼**ï¼ˆå¤šå¯¹ä¸€ï¼‰
```json
{
  "nodes": [
    {"task_id": "scan_a", "tool_name": "port_scan", "dependencies": []},
    {"task_id": "scan_b", "tool_name": "vuln_scan", "dependencies": []},
    {"task_id": "report", "tool_name": "generate_report", 
     "arguments": {"ports": "$scan_a", "vulns": "$scan_b"}, 
     "dependencies": ["scan_a", "scan_b"]}
  ]
}
```

#### è´¨é‡æ£€æŸ¥æ¸…å•
- [ ] æ‰€æœ‰ `task_id` å”¯ä¸€
- [ ] `dependencies` ä¸­çš„ä»»åŠ¡éƒ½å­˜åœ¨
- [ ] æ²¡æœ‰å¾ªç¯ä¾èµ–
- [ ] å‚æ•°ç±»å‹ç¬¦åˆå·¥å…· Schema
- [ ] å˜é‡å¼•ç”¨éƒ½æœ‰æ˜ å°„
- [ ] å¹¶è¡Œåº¦åˆç†ï¼ˆå»ºè®® 2-5ï¼‰
- [ ] JSON æ ¼å¼å®Œæ•´å¯è§£æ

---

### 2ï¸âƒ£ Execution é˜¶æ®µ - æ‰§è¡Œå™¨

**èŒè´£**: å¹¶è¡Œæ‰§è¡Œä»»åŠ¡å¹¶ç”Ÿæˆæœ€ç»ˆç”¨æˆ·å“åº”

**æ³¨æ„**: Executor æœ¬èº«ä¸éœ€è¦ LLMï¼Œä½†åœ¨ç”Ÿæˆæœ€ç»ˆå“åº”æ—¶ä¼šè°ƒç”¨ LLM

**è¾“å…¥**:
- æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œç»“æœ
- åŸå§‹ç”¨æˆ·ä»»åŠ¡
- æ‰§è¡Œç»Ÿè®¡ä¿¡æ¯

**è¾“å‡º**: ç»“æ„åŒ–çš„ä¸“ä¸šæŠ¥å‘Š

**æŠ¥å‘Šç»“æ„è¦æ±‚**:

#### 1. æ‰§è¡Œæ‘˜è¦
- æ€»ä½“æ‰§è¡Œæƒ…å†µ
- æˆåŠŸç‡ç»Ÿè®¡
- å…³é”®å‘ç°æ¦‚è§ˆ
- æ—¶é—´æ€§èƒ½æ•°æ®

#### 2. è¯¦ç»†ç»“æœ
```markdown
### å·²å®Œæˆä»»åŠ¡ (3/5)

**ä»»åŠ¡: port_scan_target1**
- çŠ¶æ€: âœ… æˆåŠŸ
- å…³é”®å‘ç°: å¼€æ”¾ç«¯å£ 22, 80, 443
- è¯¦ç»†è¾“å‡º:
  | ç«¯å£ | æœåŠ¡ | ç‰ˆæœ¬ |
  |-----|------|------|
  | 22  | SSH  | OpenSSH 7.4 |
  | 80  | HTTP | nginx 1.18 |
- æ‰§è¡Œæ—¶é—´: 2345ms

**ä»»åŠ¡: vuln_scan_web**
- çŠ¶æ€: âŒ å¤±è´¥
- é”™è¯¯ä¿¡æ¯: Connection timeout
- å»ºè®®: å¢åŠ è¶…æ—¶æ—¶é—´æˆ–æ£€æŸ¥ç½‘ç»œè¿æ¥
```

#### 3. å‘ç°çš„é—®é¢˜
æŒ‰ä¸¥é‡æ€§åˆ†ç±»ï¼š
- ğŸ”´ **ä¸¥é‡/é«˜å±**: å¯ç›´æ¥åˆ©ç”¨çš„æ¼æ´
- ğŸŸ¡ **ä¸­ç­‰**: é…ç½®é—®é¢˜ã€æ½œåœ¨é£é™©
- ğŸŸ¢ **ä½å±/ä¿¡æ¯**: ä¸€èˆ¬æ€§å‘ç°
- âšª **æ— é£é™©**: æ­£å¸¸çŠ¶æ€ç¡®è®¤

#### 4. ç»Ÿè®¡ä¿¡æ¯
```
- æ€»ä»»åŠ¡æ•°: 5
- æˆåŠŸä»»åŠ¡: 3 (60%)
- å¤±è´¥ä»»åŠ¡: 2 (40%)
- æ€»è€—æ—¶: 8234ms
- å¹³å‡è€—æ—¶: 1647ms/ä»»åŠ¡
- å¹¶è¡Œåº¦: 3
```

#### 5. å»ºè®®åç»­è¡ŒåŠ¨
1. é’ˆå¯¹æ€§çš„å…·ä½“å»ºè®®
2. ä¼˜å…ˆçº§æ’åº
3. å¯æ“ä½œçš„æ­¥éª¤

---

### 3ï¸âƒ£ Evaluation é˜¶æ®µ - è¯„ä¼°å™¨

**èŒè´£**: è¯„ä¼°æ‰§è¡Œç»“æœï¼Œå†³å®šç»§ç»­æ‰§è¡Œæˆ–å®Œæˆä»»åŠ¡

**è¾“å…¥**:
- åŸå§‹ç”¨æˆ·ç›®æ ‡
- å½“å‰è½®æ¬¡æ‰§è¡Œç»“æœ
- å†å²æ‰§è¡Œæ‘˜è¦

**è¾“å‡º**: JSON æ ¼å¼çš„å†³ç­–ç»“æœ

**å†³ç­–æ ‡å‡†**:

#### åº”è¯¥ COMPLETEï¼ˆå®Œæˆï¼‰

| æ¡ä»¶ | é˜ˆå€¼ | è¯´æ˜ |
|------|------|------|
| ç›®æ ‡å®Œæˆåº¦ | â‰¥ 80% | ä¸»è¦ç›®æ ‡å·²è¾¾æˆ |
| æˆåŠŸç‡ | < 30% | ç»§ç»­æ‰§è¡Œé£é™©é«˜ |
| æ‰§è¡Œè½®æ¬¡ | â‰¥ max | è¾¾åˆ°æœ€å¤§è½®æ¬¡ |
| ä¿¡æ¯å®Œæ•´æ€§ | æ»¡è¶³ | è·å–äº†æ ¸å¿ƒä¿¡æ¯ |
| ç»§ç»­ä»·å€¼ | ä½ | ä¸å¤ªå¯èƒ½æœ‰æ–°å‘ç° |

#### åº”è¯¥ CONTINUEï¼ˆç»§ç»­ï¼‰

| æ¡ä»¶ | é˜ˆå€¼ | è¯´æ˜ |
|------|------|------|
| ç›®æ ‡å®Œæˆåº¦ | < 60% | å…³é”®ä¿¡æ¯æœ‰ç¼ºå¤± |
| æˆåŠŸç‡ | > 50% | æ‰§è¡ŒçŠ¶æ€è‰¯å¥½ |
| æ–°å‘ç° | æœ‰ | å‘ç°äº†æ–°çš„æ”»å‡»é¢ |
| å¯é‡è¯•ä»»åŠ¡ | æœ‰ | å¤±è´¥ä»»åŠ¡å¯ä¼˜åŒ–é‡è¯• |

**è¯„ä¼°ç»´åº¦**:

1. **ç›®æ ‡å®Œæˆåº¦** (0.0-1.0)
   - å¯¹ç…§åŸå§‹ç›®æ ‡é€é¡¹æ£€æŸ¥
   - è€ƒè™‘æ˜¾æ€§å’Œéšæ€§éœ€æ±‚

2. **ä¿¡æ¯å®Œæ•´æ€§** (0.0-1.0)
   - å…³é”®å­—æ®µæ˜¯å¦é½å…¨
   - æ•°æ®è´¨é‡æ˜¯å¦æ»¡è¶³è¦æ±‚

3. **æ‰§è¡Œè´¨é‡** (0.0-1.0)
   - æˆåŠŸç‡ = æˆåŠŸæ•° / æ€»æ•°
   - å¼‚å¸¸é”™è¯¯ç‡

4. **ç»§ç»­ä»·å€¼** (0.0-1.0)
   - é¢„æœŸæ–°å‘ç°çš„å¯èƒ½æ€§
   - é£é™©æˆæœ¬æ¯”

**è¾“å‡ºæ ¼å¼ç¤ºä¾‹**:

```json
{
  "decision": "COMPLETE",
  "completion_score": 0.85,
  "confidence": 0.9,
  "reasoning": "å·²æˆåŠŸæ‰«ææ‰€æœ‰3ä¸ªç›®æ ‡ï¼Œå‘ç°å¼€æ”¾ç«¯å£ä¿¡æ¯å®Œæ•´ã€‚è™½ç„¶æœ‰1ä¸ªä»»åŠ¡è¶…æ—¶ï¼Œä½†ä¸å½±å“æ•´ä½“ç›®æ ‡è¾¾æˆã€‚",
  "key_findings": [
    "ç›®æ ‡1å¼€æ”¾22,80,443ç«¯å£ï¼Œè¿è¡ŒSSHå’ŒWebæœåŠ¡",
    "ç›®æ ‡2ä»…å¼€æ”¾80ç«¯å£ï¼Œç–‘ä¼¼WebæœåŠ¡å™¨",
    "ç›®æ ‡3æ— å“åº”ï¼Œå¯èƒ½å…³é—­æˆ–é˜²ç«å¢™æ‹¦æˆª"
  ],
  "missing_objectives": [],
  "suggested_actions": [
    "å¯¹å‘ç°çš„WebæœåŠ¡è¿›è¡Œæ·±åº¦æ‰«æ",
    "å¯¹SSHæœåŠ¡è¿›è¡Œç‰ˆæœ¬è¯†åˆ«å’Œå¼±å¯†ç æ£€æµ‹"
  ]
}
```

æˆ–

```json
{
  "decision": "CONTINUE",
  "completion_score": 0.35,
  "confidence": 0.8,
  "reasoning": "å­åŸŸåæšä¸¾åªå‘ç°2ä¸ªå­åŸŸï¼Œè¿œä½äºé¢„æœŸã€‚å»ºè®®ä½¿ç”¨ä¸åŒDNSæœåŠ¡å™¨å’Œæ›´å¤§å­—å…¸é‡è¯•ã€‚",
  "feedback": "å½“å‰æšä¸¾ç»“æœåå°‘ï¼Œéœ€è¦å¢åŠ å¤‡ç”¨DNSæŸ¥è¯¢å’Œæ‰©å±•å­—å…¸",
  "suggested_tasks": [
    "ä½¿ç”¨å…¬å…±DNSæœåŠ¡å™¨(8.8.8.8, 1.1.1.1)é‡è¯•æšä¸¾",
    "å¢åŠ å¸¸è§å­åŸŸåå­—å…¸",
    "å°è¯•è¯ä¹¦é€æ˜åº¦æ—¥å¿—æŸ¥è¯¢"
  ],
  "risk_assessment": "ä½é£é™©ï¼Œç»§ç»­æšä¸¾ä¸ä¼šè§¦å‘å®‰å…¨é˜²æŠ¤ï¼Œå»ºè®®ç»§ç»­"
}
```

---

### 4ï¸âƒ£ Replanning é˜¶æ®µ - é‡è§„åˆ’å™¨

**èŒè´£**: æ ¹æ®æ‰§è¡Œåé¦ˆé‡æ–°åˆ¶å®šä¼˜åŒ–çš„æ‰§è¡Œè®¡åˆ’

**è¾“å…¥**:
- åŸå§‹ DAG è®¡åˆ’
- æ‰§è¡Œç»“æœè¯¦æƒ…
- è¯„ä¼°å™¨çš„åé¦ˆ

**è¾“å‡º**: æ–°çš„å®Œæ•´ DAG è®¡åˆ’

**é‡è§„åˆ’ç­–ç•¥**:

#### ç­–ç•¥çŸ©é˜µ

| æ‰§è¡Œæƒ…å†µ | æˆåŠŸç‡ | å®Œæˆåº¦ | é‡‡ç”¨ç­–ç•¥ | è¡ŒåŠ¨ |
|---------|--------|--------|---------|------|
| å¤§éƒ¨åˆ†æˆåŠŸ | >70% | >60% | å¢é‡è¡¥å…… | ä¿ç•™æˆåŠŸä»»åŠ¡ï¼Œæ·»åŠ è¡¥å……ä»»åŠ¡ |
| éƒ¨åˆ†æˆåŠŸ | 40-70% | 30-60% | è°ƒæ•´ä¼˜åŒ– | åˆ†æå¤±è´¥åŸå› ï¼Œè°ƒæ•´å‚æ•°é‡è¯• |
| å¤§éƒ¨åˆ†å¤±è´¥ | <40% | <30% | é‡æ–°è§„åˆ’ | æ”¹å˜æ•´ä½“ç­–ç•¥å’Œå·¥å…·é“¾ |

#### åœºæ™¯åˆ†ç±»

**åœºæ™¯1: ä»»åŠ¡å¤±è´¥é‡è¯•**
```
é—®é¢˜: ç«¯å£æ‰«æè¶…æ—¶
åˆ†æ: æ‰«æèŒƒå›´è¿‡å¤§ï¼Œç›®æ ‡å“åº”æ…¢
è§£å†³: 
  - å‡å°‘ç«¯å£èŒƒå›´ï¼ˆåªæ‰«æå¸¸ç”¨ç«¯å£ï¼‰
  - å¢åŠ è¶…æ—¶æ—¶é—´
  - åˆ†æ‰¹æ¬¡æ‰«æ
```

**åœºæ™¯2: ä¿¡æ¯è¡¥å……**
```
é—®é¢˜: å­åŸŸåæšä¸¾ç»“æœè¿‡å°‘
åˆ†æ: å­—å…¸ä¸å¤Ÿå…¨é¢ï¼ŒDNSæœåŠ¡å™¨å•ä¸€
è§£å†³:
  - å¢åŠ è¯ä¹¦é€æ˜åº¦æŸ¥è¯¢
  - ä½¿ç”¨å¤šä¸ªå…¬å…±DNS
  - æ‰©å±•å­åŸŸåå­—å…¸
```

**åœºæ™¯3: æ·±åº¦æ¢ç´¢**
```
é—®é¢˜: å‘ç°å¼€æ”¾ç«¯å£éœ€è¦è¿›ä¸€æ­¥åˆ†æ
åˆ†æ: ç«¯å£æ‰«ææˆåŠŸï¼Œä½†ç¼ºå°‘æœåŠ¡è¯¦æƒ…
è§£å†³:
  - æ·»åŠ æœåŠ¡ç‰ˆæœ¬è¯†åˆ«ä»»åŠ¡
  - æ·»åŠ æ¼æ´æ‰«æä»»åŠ¡
  - åˆ©ç”¨å·²æœ‰ç»“æœä½œä¸ºè¾“å…¥
```

**åœºæ™¯4: ç­–ç•¥è°ƒæ•´**
```
é—®é¢˜: æš´åŠ›ç ´è§£æ— æ•ˆ
åˆ†æ: ç›®æ ‡æœ‰é˜²æŠ¤æœºåˆ¶ï¼Œå½“å‰æ–¹æ³•ä¸é€‚ç”¨
è§£å†³:
  - æ”¹ç”¨æ¼æ´æ‰«ææ–¹å¼
  - å°è¯•ä¿¡æ¯æ³„éœ²æ£€æµ‹
  - ç¤¾ä¼šå·¥ç¨‹å­¦é€”å¾„
```

**é‡è§„åˆ’æ¨¡å¼ç¤ºä¾‹**:

**æ¨¡å¼1: æ‰‡å‡ºæ‰©å±•**
```json
{
  "plan_name": "å­åŸŸåæ‰«ææ‰©å±•",
  "replanning_reason": "å‘ç°3ä¸ªæ–°å­åŸŸåï¼Œéœ€è¦é€ä¸ªæ¢æµ‹",
  "nodes": [
    {"task_id": "probe_sub1", "tool_name": "http_probe", 
     "arguments": {"domain": "$enum_result.subdomains[0]"}},
    {"task_id": "probe_sub2", "tool_name": "http_probe", 
     "arguments": {"domain": "$enum_result.subdomains[1]"}},
    {"task_id": "probe_sub3", "tool_name": "http_probe", 
     "arguments": {"domain": "$enum_result.subdomains[2]"}}
  ],
  "changes_from_original": {
    "added_tasks": ["probe_sub1", "probe_sub2", "probe_sub3"],
    "reason": "åŸºäºå­åŸŸåæšä¸¾ç»“æœæ‰©å±•æ¢æµ‹ä»»åŠ¡"
  }
}
```

**æ¨¡å¼2: å‚æ•°ä¼˜åŒ–**
```json
{
  "plan_name": "ä¼˜åŒ–ç«¯å£æ‰«æå‚æ•°",
  "replanning_reason": "åŸä»»åŠ¡è¶…æ—¶ï¼Œè°ƒæ•´å‚æ•°é‡è¯•",
  "nodes": [
    {"task_id": "retry_scan", "tool_name": "port_scan",
     "arguments": {
       "target": "192.168.1.1",
       "ports": "22,80,443,3306,3389",  // å‡å°‘ç«¯å£
       "timeout": 30000,  // å¢åŠ è¶…æ—¶
       "rate": 100  // é™ä½æ‰«æé€Ÿç‡
     },
     "retry_count": 1}
  ],
  "changes_from_original": {
    "modified_tasks": ["original_scan"],
    "reason": "è¶…æ—¶é—®é¢˜ï¼Œè°ƒæ•´å‚æ•°ï¼šå‡å°‘ç«¯å£èŒƒå›´ã€å¢åŠ è¶…æ—¶ã€é™ä½é€Ÿç‡"
  }
}
```

**æ¨¡å¼3: å·¥å…·æ›¿æ¢**
```json
{
  "plan_name": "æ›´æ¢æ‰«æå·¥å…·",
  "replanning_reason": "åŸå·¥å…·ä¸æ”¯æŒç›®æ ‡ç±»å‹ï¼Œæ›´æ¢å·¥å…·",
  "nodes": [
    {"task_id": "new_scan", "tool_name": "alternative_scanner",
     "arguments": {"target": "same_target"},
     "dependencies": []}
  ],
  "changes_from_original": {
    "removed_tasks": ["failed_scan"],
    "added_tasks": ["new_scan"],
    "reason": "åŸå·¥å…·ä¸å…¼å®¹ï¼Œæ›¿æ¢ä¸ºå¤‡ç”¨æ‰«æå™¨"
  }
}
```

**é‡è§„åˆ’æ£€æŸ¥æ¸…å•**:
- [ ] æ˜¯å¦å……åˆ†åˆ©ç”¨å·²å®Œæˆä»»åŠ¡çš„ç»“æœï¼Ÿ
- [ ] æ–°ä»»åŠ¡æ˜¯å¦é’ˆå¯¹æ€§åœ°è§£å†³äº†é—®é¢˜ï¼Ÿ
- [ ] å‚æ•°è°ƒæ•´æ˜¯å¦åˆç†ï¼ˆé¿å…é‡å¤å¤±è´¥ï¼‰ï¼Ÿ
- [ ] æ˜¯å¦ä¿ç•™äº†æœ‰ä»·å€¼çš„æ‰§è¡Œç»“æœï¼Ÿ
- [ ] ä»»åŠ¡æ•°é‡æ˜¯å¦åˆç†ï¼ˆ3-8ä¸ªï¼‰ï¼Ÿ
- [ ] ä¾èµ–å…³ç³»æ˜¯å¦æ­£ç¡®ï¼Ÿ
- [ ] æ²¡æœ‰å¾ªç¯ä¾èµ–ï¼Ÿ
- [ ] JSON æ ¼å¼å®Œæ•´å¯è§£æï¼Ÿ

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. è§„åˆ’é˜¶æ®µæœ€ä½³å®è·µ

#### DO âœ…
- ä¼˜å…ˆè¯†åˆ«å¯å¹¶è¡Œä»»åŠ¡
- åˆç†è®¾ç½®ä»»åŠ¡ä¼˜å…ˆçº§
- æ˜ç¡®æ ‡æ³¨ä¾èµ–å…³ç³»
- ä½¿ç”¨æè¿°æ€§çš„ task_id
- é¢„ä¼°åˆç†çš„æ‰§è¡Œæ—¶é—´

#### DON'T âŒ
- ä¸è¦åˆ›å»ºä¸å¿…è¦çš„ä¾èµ–
- ä¸è¦è®¾ç½®è¿‡å¤§çš„å¹¶è¡Œåº¦ï¼ˆå»ºè®®â‰¤5ï¼‰
- ä¸è¦å¿½ç•¥å·¥å…·å‚æ•°éªŒè¯
- ä¸è¦åˆ›å»ºå¾ªç¯ä¾èµ–
- ä¸è¦è§„åˆ’è¿‡å¤šä»»åŠ¡ï¼ˆå»ºè®®â‰¤10ï¼‰

### 2. è¯„ä¼°é˜¶æ®µæœ€ä½³å®è·µ

#### DO âœ…
- å®¢è§‚åˆ†ææ‰§è¡Œæ•°æ®
- è€ƒè™‘ç”¨æˆ·éšæ€§éœ€æ±‚
- æƒè¡¡ç»§ç»­æ‰§è¡Œçš„æˆæœ¬æ”¶ç›Š
- ç»™å‡ºæ˜ç¡®çš„å†³ç­–ç†ç”±
- æä¾›å¯æ“ä½œçš„å»ºè®®

#### DON'T âŒ
- ä¸è¦ä¸»è§‚è‡†æ–­ç›®æ ‡å®Œæˆåº¦
- ä¸è¦å¿½ç•¥å¤±è´¥ä»»åŠ¡çš„åŸå› 
- ä¸è¦è¿‡åº¦æ‰§è¡Œï¼ˆç›®æ ‡å·²è¾¾æˆè¿˜ç»§ç»­ï¼‰
- ä¸è¦ä½ä¼°ç»§ç»­æ‰§è¡Œçš„é£é™©
- ä¸è¦ç»™å‡ºæ¨¡ç³Šçš„å†³ç­–

### 3. é‡è§„åˆ’é˜¶æ®µæœ€ä½³å®è·µ

#### DO âœ…
- ä¿ç•™å¹¶åˆ©ç”¨æˆåŠŸä»»åŠ¡çš„ç»“æœ
- é’ˆå¯¹æ€§åœ°è§£å†³å¤±è´¥åŸå› 
- å¢é‡å¼æ”¹è¿›ï¼Œä¸æ¨å€’é‡æ¥
- åˆç†è°ƒæ•´å‚æ•°å’Œç­–ç•¥
- è®°å½•å˜æ›´åŸå› 

#### DON'T âŒ
- ä¸è¦é‡å¤æ‰§è¡ŒæˆåŠŸçš„ä»»åŠ¡
- ä¸è¦ç›²ç›®é‡è¯•å¤±è´¥ä»»åŠ¡ï¼ˆä¸æ”¹å‚æ•°ï¼‰
- ä¸è¦å¿½ç•¥è¯„ä¼°å™¨çš„åé¦ˆ
- ä¸è¦åˆ›å»ºä¸å¿…è¦çš„æ–°ä»»åŠ¡
- ä¸è¦æ”¹å˜åŸå§‹ç›®æ ‡

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. å¹¶è¡Œåº¦ä¼˜åŒ–
```
ä»»åŠ¡æ•°é‡     æ¨èå¹¶è¡Œåº¦
1-3ä¸ª        1-2
4-6ä¸ª        2-3
7-10ä¸ª       3-4
10+ä¸ª        4-5ï¼ˆä¸å»ºè®®è¶…è¿‡5ï¼‰
```

### 2. è¶…æ—¶è®¾ç½®
```
ä»»åŠ¡ç±»å‹           æ¨èè¶…æ—¶
å¿«é€ŸæŸ¥è¯¢           5-10ç§’
ç«¯å£æ‰«æ           15-30ç§’
æ¼æ´æ‰«æ           30-60ç§’
æ·±åº¦åˆ†æ           60-120ç§’
```

### 3. é‡è¯•ç­–ç•¥
```
å¤±è´¥åŸå›            é‡è¯•å»ºè®®
ç½‘ç»œè¶…æ—¶           å¢åŠ è¶…æ—¶ï¼Œé™ä½å¹¶å‘
å‚æ•°é”™è¯¯           ä¿®æ­£å‚æ•°ï¼Œä¸é‡è¯•
å·¥å…·ä¸å¯ç”¨         æ›´æ¢å·¥å…·
ç›®æ ‡ä¸å¯è¾¾         æ”¾å¼ƒæˆ–æ”¹å˜ç­–ç•¥
```

---

## ğŸ”§ ä½¿ç”¨è¯´æ˜

### 1. å¯¼å…¥æç¤ºè¯

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/a1024/code/ai/sentinel-ai

# å¯¼å…¥åˆ°æ•°æ®åº“
sqlite3 src-tauri/sentinel-ai.db < docs/llm_compiler_prompts.sql
```

### 2. åœ¨ç•Œé¢ä¸­é…ç½®

1. æ‰“å¼€åº”ç”¨ï¼Œè¿›å…¥ **è®¾ç½® > æç¤ºè¯ç®¡ç†**
2. é€‰æ‹© **LLMCompiler** æ¶æ„
3. æŸ¥çœ‹å¹¶ç¼–è¾‘å„é˜¶æ®µæç¤ºè¯
4. ä¿å­˜æ›´æ”¹

### 3. åˆ›å»ºè‡ªå®šä¹‰ç‰ˆæœ¬

1. å¤åˆ¶é»˜è®¤æç¤ºè¯
2. æ ¹æ®ç‰¹å®šåœºæ™¯ä¿®æ”¹
3. ä¿å­˜ä¸ºæ–°ç‰ˆæœ¬
4. åœ¨æç¤ºè¯ç»„ä¸­å…³è”

### 4. æµ‹è¯•å’ŒéªŒè¯

```bash
# è¿è¡Œæµ‹è¯•
cargo test llm_compiler --package sentinel-ai

# æŸ¥çœ‹æ—¥å¿—
tail -f src-tauri/logs/sentinel-ai.log
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [LLM Compiler è®ºæ–‡](https://arxiv.org/abs/2312.04511)
- [DAG ä»»åŠ¡è°ƒåº¦åŸç†](https://en.wikipedia.org/wiki/Directed_acyclic_graph)
- [Sentinel AI æ¶æ„æ–‡æ¡£](./ARCHITECTURE.md)

---

## ğŸ¤ è´¡çŒ®

å¦‚æœä½ æœ‰æ›´å¥½çš„æç¤ºè¯è®¾è®¡æˆ–ä½¿ç”¨ç»éªŒï¼Œæ¬¢è¿è´¡çŒ®ï¼š

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤æ”¹è¿›çš„æç¤ºè¯
4. å‘èµ· Pull Request

---

## ğŸ“ æ›´æ–°æ—¥å¿—

- **2025-11-13**: åˆå§‹ç‰ˆæœ¬ï¼ŒåŒ…å«4ä¸ªæ ¸å¿ƒé˜¶æ®µçš„æç¤ºè¯
- åç»­ç‰ˆæœ¬å°†æ ¹æ®ä½¿ç”¨åé¦ˆæŒç»­ä¼˜åŒ–

---

**ç»´æŠ¤è€…**: Sentinel AI Team  
**æœ€åæ›´æ–°**: 2025-11-13

