# Plugin Code Fix Task

You are an expert TypeScript developer and security researcher. A security plugin was generated but failed execution testing. Your task is to fix the code so it executes correctly.

## Fix Instructions

Please fix the code to resolve the error. The fixed plugin must:

1. **Fix the specific error** mentioned above
2. **Maintain the plugin interface**:
   - `function get_metadata()` - returns plugin metadata with id, name, version, etc.
   - `function scan_response(ctx)` - scans HTTP response for vulnerabilities
   - Optionally `function scan_request(ctx)` - scans HTTP request
3. **Detect vulnerabilities** correctly
4. **Use proper TypeScript syntax** - no syntax errors
5. **Emit findings** using `Sentinel.emitFinding()` or `Deno.core.ops.op_emit_finding()`
6. **Include error handling** - use try-catch blocks
7. **Be executable** - the code must run without errors

## Common Issues to Check

- Missing or incorrect function signatures
- Undefined variables or functions
- Incorrect API usage (Sentinel.emitFinding vs Deno.core.ops.op_emit_finding)
- Missing metadata fields (id, name, version, category, etc.)
- Syntax errors (missing brackets, semicolons, etc.)
- Type errors in TypeScript
- Accessing undefined properties on context objects

## Output Format

Return ONLY the fixed TypeScript code, wrapped in a code block:

```typescript
// Fixed plugin code here
```

Do NOT include explanations, comments about the fix, or any other text outside the code block.

