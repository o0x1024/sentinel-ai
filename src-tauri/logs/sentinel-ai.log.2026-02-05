 INFO sentinel_ai_lib: 219: Debug mode: license check skipped
 INFO sentinel_ai_lib: 237: Loaded database config from file: "/Users/a1024/Library/Application Support/sentinel-ai/db_config.json"
 INFO sentinel_ai_lib: 275: Dictionary pool initialized for plugins
 INFO sentinel_ai_lib::commands::tool_commands::agent_config: 220: Agent configuration initialized from database
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::commands::rag_commands: 124: 数据库中未找到RAG配置，使用默认配置
 INFO sentinel_ai_lib::commands::rag_commands: 148: 从 AI 配置中获取嵌入服务地址: http://localhost:11434
 INFO sentinel_rag::service: 31: 初始化RAG服务 (使用 Rig + LanceDB)
 INFO sentinel_rag::service: 66: RAG服务使用LanceDB路径: /Users/a1024/Library/Application Support/sentinel-ai/AppData/lancedb
 INFO sentinel_rag::database: 40: LanceDB connected at: /Users/a1024/Library/Application Support/sentinel-ai/AppData/lancedb
 INFO sentinel_rag::service: 121: 默认RAG集合已存在
 INFO sentinel_rag::database: 44: Collection will be created on first insert
 INFO sentinel_ai_lib::commands::rag_commands: 189: Global RAG service initialized successfully
 INFO sentinel_ai_lib::commands::rag_commands: 1153: Ensuring memory collection exists
 INFO sentinel_rag::service: 1155: 获取RAG状态
 INFO sentinel_ai_lib::commands::rag_commands: 1163: Memory collection already exists: 5deac8e3-7cee-480d-accd-0653a0073328
 INFO sentinel_ai_lib: 296: Memory collection ready: 5deac8e3-7cee-480d-accd-0653a0073328
 INFO sentinel_traffic::history_cache: 253: Creating ProxyHistoryCache with max_http=5000, max_ws_conn=500, max_msg_per_conn=2000, retention=3600s, auto_persist=true
DEBUG sentinel_ai_lib::services::ai_manager: 343: Initializing default AI services...
DEBUG sentinel_ai_lib::services::ai_manager: 355: Successfully parsed 'providers_config' from DB.
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: DeepSeek
 WARN sentinel_ai_lib::services::ai_manager: 393: Provider DeepSeek has no default model configured, service may not work properly
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider DeepSeek using rig_provider: deepseek, model: 
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: Anthropic
 WARN sentinel_ai_lib::services::ai_manager: 393: Provider Anthropic has no default model configured, service may not work properly
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider Anthropic using rig_provider: anthropic, model: 
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: Moonshot
DEBUG sentinel_ai_lib::services::ai_manager: 383: Using global default model for Moonshot: kimi-k2.5
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider Moonshot using rig_provider: moonshot, model: kimi-k2.5
 INFO sentinel_ai_lib::services::ai_manager: 557: Default service alias now points to 'moonshot'
DEBUG sentinel_ai_lib::services::ai_manager: 489: Finished initializing AI services. Total: 4
 INFO sentinel_ai_lib::agents::tenth_man_executor: 330: Tenth Man executor initialized
 INFO sentinel_ai_lib: 480: Tenth Man executor initialized
 INFO sentinel_ai_lib::agents::subagent_executor: 790: Subagent executors initialized (spawn/wait/run)
 INFO sentinel_ai_lib: 485: Subagent executor initialized
 INFO sentinel_ai_lib::trackers::tool_execution_tracker: 185: Tool execution tracker initialized
 INFO sentinel_ai_lib: 489: Tool execution tracker initialized
 INFO sentinel_ai_lib::commands::tool_commands::shell_permissions: 114: Shell config loaded from database on startup
 INFO sentinel_ai_lib: 496: Workflow engine and scheduler initialized
 INFO sentinel_ai_lib: 513: Starting agent-browser daemon...
 INFO sentinel_ai_lib: 517: Agent-browser daemon started successfully
 INFO sentinel_ai_lib::commands::cache_commands: 113: Cleaned up 0 expired cache entries
 INFO sentinel_ai_lib::commands::plugin_review_commands: 273: Getting plugin statistics
 INFO sentinel_ai_lib::commands::tool_commands::shell_permissions: 114: Shell config loaded from database on startup
 INFO sentinel_ai_lib::commands::plugin_review_commands: 478: Getting plugin review statistics
 INFO sentinel_rag::service: 1155: 获取RAG状态
 INFO sentinel_ai_lib: 1322: Checking if proxy auto-start is enabled...
 INFO sentinel_ai_lib: 1361: No saved proxy configuration found, using default
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 446: No saved intercept filter rules found
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 475: Loaded 0 request filter rules
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 480: Loaded 0 response filter rules
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 491: Loaded traffic analysis plugin scanning enabled: true
 INFO sentinel_traffic::scanner: 645: Loading enabled plugins from database...
 INFO sentinel_traffic::proxy: 2551: Proxy bound to port 8080
 INFO sentinel_traffic::certificate: 141: Root CA already exists at /Users/a1024/Library/Application Support/sentinel-ai/ca/root-ca.pem
 INFO sentinel_traffic::scanner: 728: Loaded 0 enabled plugins from database
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 556: Loaded 0 enabled plugins into ScanPipeline
 INFO sentinel_traffic::scanner: 123: ScanPipeline started
 INFO sentinel_traffic::scanner: 1333: FindingDeduplicator started
 WARN sentinel_traffic::proxy: 2574: Root CA not trusted in macOS System keychain. Attempting to add trust...
 WARN sentinel_traffic::proxy: 2578: Auto trust failed: 证书错误: Failed to trust CA: SecCertificateAddToKeychain: Write permissions error.
. You may need to import /Users/a1024/Library/Application Support/sentinel-ai/ca/root-ca.pem into System keychain and set to 'Always Trust'.
 INFO sentinel_traffic::proxy: 2629: Checking upstream proxy config: None
 INFO sentinel_traffic::proxy: 2646: Use upstream proxy decision: false
 INFO sentinel_traffic::proxy: 2701: Starting HTTPS MITM proxy on port 8080 (ignoring upstream cert errors)
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 836: Traffic scan started on port 8080 (ScanPipeline running in dedicated thread)
 INFO sentinel_ai_lib: 1373: ✅ Proxy listener auto-started successfully on port 8080
 INFO sentinel_ai_lib: 526: Starting delayed MCP server auto-connect...
DEBUG sentinel_ai_lib: 579: Plugin cert_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of domains or URLs to monitor certificates")}, "timeout": Object {"type": String("integer"), "description": String("Connection timeout in milliseconds"), "default": Number(10000), "minimum": Number(5000), "maximum": Number(60000)}, "checkExpiry": Object {"type": String("boolean"), "description": String("Check certificate expiry dates"), "default": Bool(true)}, "expiryWarningDays": Object {"type": String("integer"), "description": String("Days before expiry to generate warning"), "default": Number(30), "minimum": Number(1), "maximum": Number(365)}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous certificate snapshots for comparison"), "additionalProperties": Object {"type": String("object"), "properties": Object {"domain": Object {"type": String("string")}, "fingerprint": Object {"type": String("string")}, "validTo": Object {"type": String("string")}, "issuer": Object {"type": String("string")}, "lastChecked": Object {"type": String("string")}}}}}}
DEBUG sentinel_ai_lib: 579: Plugin api_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of base URLs to monitor for API changes")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "crawlDepth": Object {"type": String("integer"), "description": String("Depth to crawl for JS files"), "default": Number(1), "minimum": Number(0), "maximum": Number(3)}, "includeGraphQL": Object {"type": String("boolean"), "description": String("Check for GraphQL endpoints"), "default": Bool(true)}, "includeOpenAPI": Object {"type": String("boolean"), "description": String("Check for OpenAPI/Swagger specs"), "default": Bool(true)}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous API snapshots for comparison")}}}
DEBUG sentinel_ai_lib: 579: Plugin sql_injection_scanner input_schema: Object {"type": String("object"), "required": Array [String("url")], "properties": Object {"url": Object {"type": String("string"), "description": String("Target URL to test for SQL injection vulnerabilities")}, "method": Object {"type": String("string"), "enum": Array [String("GET"), String("POST"), String("PUT"), String("PATCH")], "description": String("HTTP method to use"), "default": String("GET")}, "params": Object {"type": String("object"), "description": String("URL parameters to test (key-value pairs)"), "additionalProperties": Object {"type": String("string")}}, "headers": Object {"type": String("object"), "description": String("Custom headers to include"), "additionalProperties": Object {"type": String("string")}}, "body": Object {"type": String("string"), "description": String("Request body (for POST/PUT/PATCH)")}, "contentType": Object {"type": String("string"), "description": String("Content-Type header"), "default": String("application/x-www-form-urlencoded")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests"), "default": Number(3), "minimum": Number(1), "maximum": Number(10)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "testErrorBased": Object {"type": String("boolean"), "description": String("Test for error-based SQL injection"), "default": Bool(true)}, "testBlind": Object {"type": String("boolean"), "description": String("Test for blind boolean-based SQL injection"), "default": Bool(true)}, "testTimeBased": Object {"type": String("boolean"), "description": String("Test for time-based blind SQL injection"), "default": Bool(true)}, "testUnion": Object {"type": String("boolean"), "description": String("Test for UNION-based SQL injection"), "default": Bool(true)}, "dbType": Object {"type": String("string"), "enum": Array [String("auto"), String("mysql"), String("postgresql"), String("mssql"), String("oracle"), String("sqlite")], "description": String("Target database type (auto for detection)"), "default": String("auto")}, "customPayloads": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Custom SQL injection payloads to test")}, "dictionaryId": Object {"type": String("string"), "description": String("Dictionary ID or name for SQLi payloads")}, "timeThreshold": Object {"type": String("integer"), "description": String("Time threshold in ms for time-based detection"), "default": Number(5000), "minimum": Number(3000), "maximum": Number(30000)}}}
DEBUG sentinel_ai_lib: 579: Plugin port_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of hosts/IPs to scan for port changes")}, "ports": Object {"type": String("array"), "items": Object {"type": String("integer")}, "description": String("Specific ports to scan (default: common ports)")}, "timeout": Object {"type": String("integer"), "description": String("Connection timeout in milliseconds per port"), "default": Number(3000), "minimum": Number(1000), "maximum": Number(30000)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent port checks"), "default": Number(10), "minimum": Number(1), "maximum": Number(50)}, "detectService": Object {"type": String("boolean"), "description": String("Try to detect service on open ports"), "default": Bool(true)}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous port snapshots for comparison")}}}
DEBUG sentinel_ai_lib: 579: Plugin js_link_finder input_schema: Object {"type": String("object"), "properties": Object {"url": Object {"type": String("string"), "description": String("Single target URL (use 'urls' for multiple targets)")}, "urls": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Array of target URLs to find JavaScript files from (supports batch processing)")}, "timeout": Object {"type": String("number"), "description": String("Request timeout in milliseconds (default: 15000)")}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "recursive": Object {"type": String("boolean"), "description": String("Recursively crawl same-origin pages to find more JS (default: false)")}, "maxDepth": Object {"type": String("number"), "description": String("Maximum crawl depth when recursive is enabled (default: 2)")}, "maxFiles": Object {"type": String("number"), "description": String("Maximum JS files to collect per URL (default: 100)")}, "includeSameOriginOnly": Object {"type": String("boolean"), "description": String("Only include JS files from the same origin (default: false)")}, "includeInline": Object {"type": String("boolean"), "description": String("Include inline <script> content hashes (default: true)")}, "followSourceMaps": Object {"type": String("boolean"), "description": String("Follow sourceMappingURL to find source maps (default: true)")}, "probeSpaManifests": Object {"type": String("boolean"), "description": String("Probe common SPA manifest endpoints (default: true)")}, "concurrency": Object {"type": String("number"), "description": String("Number of concurrent requests (default: 100)")}}}
DEBUG sentinel_ai_lib: 579: Plugin http_prober input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of targets to probe (domains, IPs, or URLs)")}, "ports": Object {"type": String("array"), "items": Object {"type": String("integer")}, "description": String("Ports to probe. Default: 80, 443, 8080, 8443"), "default": Array [Number(80), Number(443), Number(8080), Number(8443)]}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(10000), "minimum": Number(1000), "maximum": Number(60000)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests"), "default": Number(10), "minimum": Number(1), "maximum": Number(50)}, "followRedirects": Object {"type": String("boolean"), "description": String("Follow HTTP redirects"), "default": Bool(true)}, "maxRedirects": Object {"type": String("integer"), "description": String("Maximum number of redirects to follow"), "default": Number(5)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header"), "default": String("Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36")}, "extractTitle": Object {"type": String("boolean"), "description": String("Extract page title from HTML"), "default": Bool(true)}, "extractHeaders": Object {"type": String("boolean"), "description": String("Include response headers in results"), "default": Bool(false)}, "checkHttps": Object {"type": String("boolean"), "description": String("Check HTTPS protocol"), "default": Bool(true)}, "checkHttp": Object {"type": String("boolean"), "description": String("Check HTTP protocol"), "default": Bool(true)}}}
DEBUG sentinel_ai_lib: 579: Plugin js_analyzer input_schema: Object {"type": String("object"), "properties": Object {"url": Object {"type": String("string"), "description": String("Single target URL (HTML page or JavaScript file, use 'urls' for multiple targets)")}, "urls": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Array of target URLs to analyze (supports batch processing)")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "maxFileSize": Object {"type": String("integer"), "description": String("Maximum file size to analyze in bytes"), "default": Number(5242880), "minimum": Number(102400), "maximum": Number(52428800)}, "extractEndpoints": Object {"type": String("boolean"), "description": String("Extract API endpoints"), "default": Bool(true)}, "extractSecrets": Object {"type": String("boolean"), "description": String("Extract secrets and sensitive data"), "default": Bool(true)}, "extractDomains": Object {"type": String("boolean"), "description": String("Extract referenced domains"), "default": Bool(true)}, "followImports": Object {"type": String("boolean"), "description": String("Follow and analyze imported JS files"), "default": Bool(true)}, "maxFiles": Object {"type": String("integer"), "description": String("Maximum number of JS files to analyze per URL"), "default": Number(20), "minimum": Number(1), "maximum": Number(100)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests (default: 100)"), "default": Number(100), "minimum": Number(1), "maximum": Number(200)}}}
DEBUG sentinel_ai_lib: 579: Plugin subdomain_enumerator input_schema: Object {"type": String("object"), "required": Array [String("domain")], "properties": Object {"domain": Object {"type": String("string"), "description": String("Target domain to enumerate subdomains for (e.g., 'example.com')")}, "sources": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Data sources to query. Available: crtsh, certspotter, censys, google_ct, myssl, racent, hackertarget, rapiddns, anubis, dnsdumpster, sublist3r, bevigil, binaryedge, cebaidu, chinaz, chinaz_api, circl, cloudflare, dnsdb, dnsgrep, fullhunt, ip138, ipv4info, netcraft, passivedns, qianxun, riddler, robtex, securitytrails, sitedossier, spyse, windvane, alienvault, virustotal, virustotal_api, riskiq, threatbook, threatminer, urlscan, bing_api, fofa, gitee, github, google_api, hunter, quake, shodan, zoomeye, cdx, archive. Default: all sources"), "default": Array [String("crtsh"), String("certspotter"), String("censys"), String("google_ct"), String("myssl"), String("racent"), String("hackertarget"), String("rapiddns"), String("anubis"), String("dnsdumpster"), String("sublist3r"), String("bevigil"), String("binaryedge"), String("cebaidu"), String("chinaz"), String("chinaz_api"), String("circl"), String("cloudflare"), String("dnsdb"), String("dnsgrep"), String("fullhunt"), String("ip138"), String("ipv4info"), String("netcraft"), String("passivedns"), String("qianxun"), String("riddler"), String("robtex"), String("securitytrails"), String("sitedossier"), String("spyse"), String("windvane"), String("alienvault"), String("virustotal"), String("virustotal_api"), String("riskiq"), String("threatbook"), String("threatminer"), String("urlscan"), String("bing_api"), String("fofa"), String("gitee"), String("github"), String("google_api"), String("hunter"), String("quake"), String("shodan"), String("zoomeye"), String("cdx"), String("archive")]}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests"), "default": Number(5), "minimum": Number(1), "maximum": Number(10)}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(30000), "minimum": Number(5000), "maximum": Number(120000)}, "removeDuplicates": Object {"type": String("boolean"), "description": String("Remove duplicate subdomains from results"), "default": Bool(true)}, "apiConfig": Object {"type": String("object"), "description": String("API keys and credentials for various data sources"), "properties": Object {"censys_id": Object {"type": String("string"), "description": String("Censys API ID")}, "censys_secret": Object {"type": String("string"), "description": String("Censys API Secret")}, "racent_token": Object {"type": String("string"), "description": String("Racent API token")}, "bevigil_token": Object {"type": String("string"), "description": String("BeVigil API token")}, "binaryedge_token": Object {"type": String("string"), "description": String("BinaryEdge API token")}, "chinaz_token": Object {"type": String("string"), "description": String("Chinaz API key")}, "circl_user": Object {"type": String("string"), "description": String("CIRCL username")}, "circl_pass": Object {"type": String("string"), "description": String("CIRCL password")}, "cloudflare_token": Object {"type": String("string"), "description": String("Cloudflare API token")}, "dnsdb_token": Object {"type": String("string"), "description": String("DNSDB API key")}, "fullhunt_token": Object {"type": String("string"), "description": String("FullHunt API token")}, "ipv4info_token": Object {"type": String("string"), "description": String("IPv4Info API key")}, "passivedns_token": Object {"type": String("string"), "description": String("PassiveDNS API token")}, "passivedns_addr": Object {"type": String("string"), "description": String("PassiveDNS API address")}, "securitytrails_token": Object {"type": String("string"), "description": String("SecurityTrails API token")}, "spyse_token": Object {"type": String("string"), "description": String("Spyse API token")}, "windvane_token": Object {"type": String("string"), "description": String("Windvane API token")}, "riskiq_user": Object {"type": String("string"), "description": String("RiskIQ username")}, "riskiq_key": Object {"type": String("string"), "description": String("RiskIQ API key")}, "threatbook_token": Object {"type": String("string"), "description": String("ThreatBook API token")}, "virustotal_token": Object {"type": String("string"), "description": String("VirusTotal API token")}, "bing_token": Object {"type": String("string"), "description": String("Bing API key")}, "fofa_email": Object {"type": String("string"), "description": String("FOFA email")}, "fofa_key": Object {"type": String("string"), "description": String("FOFA API key")}, "github_token": Object {"type": String("string"), "description": String("GitHub API token")}, "google_key": Object {"type": String("string"), "description": String("Google API key")}, "google_cx": Object {"type": String("string"), "description": String("Google Custom Search Engine ID")}, "hunter_token": Object {"type": String("string"), "description": String("Hunter API token")}, "quake_token": Object {"type": String("string"), "description": String("Quake API token")}, "shodan_token": Object {"type": String("string"), "description": String("Shodan API token")}, "zoomeye_token": Object {"type": String("string"), "description": String("ZoomEye API token")}}}}}
DEBUG sentinel_ai_lib: 579: Plugin content_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of URLs to monitor for content changes")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "includeHeaders": Object {"type": String("boolean"), "description": String("Include response headers in snapshot"), "default": Bool(false)}, "excludePatterns": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Regex patterns to exclude from content hash (e.g., timestamps)")}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous content snapshots for comparison")}}}
 INFO sentinel_ai_lib: 592: Loading 9 plugin tools...
 INFO sentinel_ai_lib::commands::mcp_commands: 386: Auto-connecting MCP servers...
 INFO sentinel_ai_lib::commands::mcp_commands: 536: Auto-connect MCP servers completed
 INFO sentinel_ai_lib::commands::ai: 2646: Loaded global tool config from database
 INFO sentinel_ai_lib::commands::ai: 2190: Using tool config from frontend request
 INFO sentinel_ai_lib::commands::ai: 2196: Agent execute: conv=4f5f6887-9cda-4db1-bace-54e4a7dac160, msg=89030b6d-4781-493d-9525-21d8f4d30bb8, rag=false, tools=true
 INFO sentinel_ai_lib::commands::ai: 2210: Using default chat model: moonshot/kimi-k2.5
 INFO sentinel_ai_lib::commands::ai: 2241: Setting output storage threshold to 10000 bytes (Dynamic Context Discovery)
 INFO sentinel_ai_lib::commands::ai: 2394: Using role prompt: 123
 INFO sentinel_ai_lib::commands::ai: 2537: Using tool-enabled agent executor for conversation: 4f5f6887-9cda-4db1-bace-54e4a7dac160
 INFO sentinel_ai_lib::agents::executor: 58: Executing agent - rig_provider: moonshot, model: kimi-k2.5, execution_id: 4f5f6887-9cda-4db1-bace-54e4a7dac160, tools_enabled: true, recursion_depth: 0
 INFO sentinel_ai_lib::agents::executor: 122: Tenth Man initialized for execution_id: 4f5f6887-9cda-4db1-bace-54e4a7dac160 (rule_enabled: false)
 INFO sentinel_ai_lib::agents::executor: 131: Refreshing MCP tools before execution...
 INFO sentinel_ai_lib::agents::executor: 184: Registered WebExplorerTool
 INFO sentinel_ai_lib::agents::executor: 194: ToolServer has 41 registered tools: ["plugin__port_monitor", "memory_manager", "browser_scroll", "browser_open", "interactive_shell", "browser_fill", "browser_click", "shell", "http_request", "browser_wait", "ocr", "todos", "browser_select", "browser_close", "plugin__js_link_finder", "plugin__js_analyzer", "local_time", "web_search", "subagent_run", "port_scan", "browser_type", "browser_get_text", "browser_press", "browser_screenshot", "browser_evaluate", "plugin__cert_monitor", "plugin__api_monitor", "web_explorer", "subagent_spawn", "browser_snapshot", "browser_get_url", "skills", "plugin__sql_injection_scanner", "plugin__content_monitor", "plugin__subdomain_enumerator", "subdomain_brute", "browser_back", "plugin__http_prober", "tenth_man_review", "subagent_wait", "browser_hover"]
 INFO sentinel_ai_lib::agents::tool_router: 1102: Loaded 0 workflow tools (is_tool=true)
 INFO sentinel_ai_lib::agents::tool_router: 1336: Loaded 9 plugin tools from database
 INFO sentinel_ai_lib::agents::tool_router: 1284: Loaded 0 MCP tools
 INFO sentinel_ai_lib::agents::executor::run_with_tools: 63: Selected 1 tools for execution_id 4f5f6887-9cda-4db1-bace-54e4a7dac160: ["http_request"]
 INFO sentinel_ai_lib::agents::context_engineering::builder: 175: Injected working directory into system prompt: /workspace/context
 INFO sentinel_ai_lib::agents::context_engineering::builder: 257: Conversation history exported to container: /workspace/context/history_4f5f6887-9cd.txt
 INFO sentinel_ai_lib::agents::context_engineering::builder: 361: Context usage - execution_id: 4f5f6887-9cda-4db1-bace-54e4a7dac160, system: 738, history: 22, summary: 0, used: 760, max: 128000
 INFO sentinel_ai_lib::agents::executor::run_with_tools: 230: Got 1 dynamic tool instances for rig-core native tool calling
 INFO sentinel_llm::streaming: 163: StreamingLlmClient - Provider: moonshot, Model: kimi-k2.5, Tools: ["http_request"], History: 0 messages
 INFO sentinel_llm::streaming: 246: Unknown provider 'moonshot', trying OpenAI compatible mode (via Generic Client)
 INFO sentinel_llm::streaming: 649: Adding dynamic tool to agent: http_request
 INFO sentinel_llm::streaming: 670: Starting stream iteration...
 INFO sentinel_llm::streaming: 674: Using max_turns: 200
 INFO sentinel_llm::streaming: 678: Final chat_history has 0 messages
 INFO sentinel_llm::streaming: 681: Using stream_prompt for empty chat history
 INFO sentinel_traffic::scanner: 888: Found x-sentinel-internal header with value: true
 INFO sentinel_ai_lib::commands::packet_capture_commands: 57: Getting network interfaces
 INFO sentinel_ai_lib::commands::proxifier_commands: 560: Loaded 0 proxies from database
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 3508: Getting proxy configuration
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 3529: No saved configuration found, using default
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 3508: Getting proxy configuration
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 3529: No saved configuration found, using default
 INFO sentinel_ai_lib::commands::proxifier_commands: 631: Loaded 0 rules from database
 INFO sentinel_ai_lib: 219: Debug mode: license check skipped
 INFO sentinel_ai_lib: 237: Loaded database config from file: "/Users/a1024/Library/Application Support/sentinel-ai/db_config.json"
 INFO sentinel_ai_lib: 275: Dictionary pool initialized for plugins
 INFO sentinel_ai_lib::commands::tool_commands::agent_config: 220: Agent configuration initialized from database
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::commands::rag_commands: 124: 数据库中未找到RAG配置，使用默认配置
 INFO sentinel_ai_lib::commands::rag_commands: 148: 从 AI 配置中获取嵌入服务地址: http://localhost:11434
 INFO sentinel_rag::service: 31: 初始化RAG服务 (使用 Rig + LanceDB)
 INFO sentinel_rag::service: 66: RAG服务使用LanceDB路径: /Users/a1024/Library/Application Support/sentinel-ai/AppData/lancedb
 INFO sentinel_rag::database: 40: LanceDB connected at: /Users/a1024/Library/Application Support/sentinel-ai/AppData/lancedb
 INFO sentinel_rag::service: 121: 默认RAG集合已存在
 INFO sentinel_rag::database: 44: Collection will be created on first insert
 INFO sentinel_ai_lib::commands::rag_commands: 189: Global RAG service initialized successfully
 INFO sentinel_ai_lib::commands::rag_commands: 1153: Ensuring memory collection exists
 INFO sentinel_rag::service: 1155: 获取RAG状态
 INFO sentinel_ai_lib::commands::rag_commands: 1163: Memory collection already exists: 5deac8e3-7cee-480d-accd-0653a0073328
 INFO sentinel_ai_lib: 296: Memory collection ready: 5deac8e3-7cee-480d-accd-0653a0073328
 INFO sentinel_traffic::history_cache: 253: Creating ProxyHistoryCache with max_http=5000, max_ws_conn=500, max_msg_per_conn=2000, retention=3600s, auto_persist=true
DEBUG sentinel_ai_lib::services::ai_manager: 343: Initializing default AI services...
DEBUG sentinel_ai_lib::services::ai_manager: 355: Successfully parsed 'providers_config' from DB.
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: Anthropic
 WARN sentinel_ai_lib::services::ai_manager: 393: Provider Anthropic has no default model configured, service may not work properly
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider Anthropic using rig_provider: anthropic, model: 
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: Moonshot
DEBUG sentinel_ai_lib::services::ai_manager: 383: Using global default model for Moonshot: kimi-k2.5
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider Moonshot using rig_provider: moonshot, model: kimi-k2.5
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: DeepSeek
 WARN sentinel_ai_lib::services::ai_manager: 393: Provider DeepSeek has no default model configured, service may not work properly
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider DeepSeek using rig_provider: deepseek, model: 
 INFO sentinel_ai_lib::services::ai_manager: 557: Default service alias now points to 'moonshot'
DEBUG sentinel_ai_lib::services::ai_manager: 489: Finished initializing AI services. Total: 4
 INFO sentinel_ai_lib::agents::tenth_man_executor: 330: Tenth Man executor initialized
 INFO sentinel_ai_lib: 480: Tenth Man executor initialized
 INFO sentinel_ai_lib::agents::subagent_executor: 790: Subagent executors initialized (spawn/wait/run)
 INFO sentinel_ai_lib: 485: Subagent executor initialized
 INFO sentinel_ai_lib::trackers::tool_execution_tracker: 185: Tool execution tracker initialized
 INFO sentinel_ai_lib: 489: Tool execution tracker initialized
 INFO sentinel_ai_lib::commands::tool_commands::shell_permissions: 114: Shell config loaded from database on startup
 INFO sentinel_ai_lib: 496: Workflow engine and scheduler initialized
 INFO sentinel_ai_lib::commands::cache_commands: 113: Cleaned up 0 expired cache entries
 INFO sentinel_ai_lib::commands::plugin_review_commands: 273: Getting plugin statistics
 INFO sentinel_ai_lib::commands::tool_commands::shell_permissions: 114: Shell config loaded from database on startup
 INFO sentinel_ai_lib::commands::plugin_review_commands: 478: Getting plugin review statistics
 INFO sentinel_rag::service: 1155: 获取RAG状态
 INFO sentinel_ai_lib: 513: Starting agent-browser daemon...
 INFO sentinel_ai_lib: 517: Agent-browser daemon started successfully
 INFO sentinel_ai_lib: 1322: Checking if proxy auto-start is enabled...
 INFO sentinel_ai_lib: 1361: No saved proxy configuration found, using default
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 446: No saved intercept filter rules found
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 475: Loaded 0 request filter rules
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 480: Loaded 0 response filter rules
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 491: Loaded traffic analysis plugin scanning enabled: true
 INFO sentinel_traffic::scanner: 645: Loading enabled plugins from database...
 INFO sentinel_traffic::proxy: 2551: Proxy bound to port 8080
 INFO sentinel_traffic::certificate: 141: Root CA already exists at /Users/a1024/Library/Application Support/sentinel-ai/ca/root-ca.pem
 INFO sentinel_traffic::scanner: 728: Loaded 0 enabled plugins from database
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 556: Loaded 0 enabled plugins into ScanPipeline
 INFO sentinel_traffic::scanner: 123: ScanPipeline started
 INFO sentinel_traffic::scanner: 1333: FindingDeduplicator started
 WARN sentinel_traffic::proxy: 2574: Root CA not trusted in macOS System keychain. Attempting to add trust...
 WARN sentinel_traffic::proxy: 2578: Auto trust failed: 证书错误: Failed to trust CA: SecCertificateAddToKeychain: Write permissions error.
. You may need to import /Users/a1024/Library/Application Support/sentinel-ai/ca/root-ca.pem into System keychain and set to 'Always Trust'.
 INFO sentinel_traffic::proxy: 2629: Checking upstream proxy config: None
 INFO sentinel_traffic::proxy: 2646: Use upstream proxy decision: false
 INFO sentinel_traffic::proxy: 2701: Starting HTTPS MITM proxy on port 8080 (ignoring upstream cert errors)
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 836: Traffic scan started on port 8080 (ScanPipeline running in dedicated thread)
 INFO sentinel_ai_lib: 1373: ✅ Proxy listener auto-started successfully on port 8080
 INFO sentinel_ai_lib::commands::ai: 2646: Loaded global tool config from database
 INFO sentinel_ai_lib: 526: Starting delayed MCP server auto-connect...
DEBUG sentinel_ai_lib: 579: Plugin cert_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of domains or URLs to monitor certificates")}, "timeout": Object {"type": String("integer"), "description": String("Connection timeout in milliseconds"), "default": Number(10000), "minimum": Number(5000), "maximum": Number(60000)}, "checkExpiry": Object {"type": String("boolean"), "description": String("Check certificate expiry dates"), "default": Bool(true)}, "expiryWarningDays": Object {"type": String("integer"), "description": String("Days before expiry to generate warning"), "default": Number(30), "minimum": Number(1), "maximum": Number(365)}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous certificate snapshots for comparison"), "additionalProperties": Object {"type": String("object"), "properties": Object {"domain": Object {"type": String("string")}, "fingerprint": Object {"type": String("string")}, "validTo": Object {"type": String("string")}, "issuer": Object {"type": String("string")}, "lastChecked": Object {"type": String("string")}}}}}}
DEBUG sentinel_ai_lib: 579: Plugin api_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of base URLs to monitor for API changes")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "crawlDepth": Object {"type": String("integer"), "description": String("Depth to crawl for JS files"), "default": Number(1), "minimum": Number(0), "maximum": Number(3)}, "includeGraphQL": Object {"type": String("boolean"), "description": String("Check for GraphQL endpoints"), "default": Bool(true)}, "includeOpenAPI": Object {"type": String("boolean"), "description": String("Check for OpenAPI/Swagger specs"), "default": Bool(true)}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous API snapshots for comparison")}}}
DEBUG sentinel_ai_lib: 579: Plugin sql_injection_scanner input_schema: Object {"type": String("object"), "required": Array [String("url")], "properties": Object {"url": Object {"type": String("string"), "description": String("Target URL to test for SQL injection vulnerabilities")}, "method": Object {"type": String("string"), "enum": Array [String("GET"), String("POST"), String("PUT"), String("PATCH")], "description": String("HTTP method to use"), "default": String("GET")}, "params": Object {"type": String("object"), "description": String("URL parameters to test (key-value pairs)"), "additionalProperties": Object {"type": String("string")}}, "headers": Object {"type": String("object"), "description": String("Custom headers to include"), "additionalProperties": Object {"type": String("string")}}, "body": Object {"type": String("string"), "description": String("Request body (for POST/PUT/PATCH)")}, "contentType": Object {"type": String("string"), "description": String("Content-Type header"), "default": String("application/x-www-form-urlencoded")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests"), "default": Number(3), "minimum": Number(1), "maximum": Number(10)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "testErrorBased": Object {"type": String("boolean"), "description": String("Test for error-based SQL injection"), "default": Bool(true)}, "testBlind": Object {"type": String("boolean"), "description": String("Test for blind boolean-based SQL injection"), "default": Bool(true)}, "testTimeBased": Object {"type": String("boolean"), "description": String("Test for time-based blind SQL injection"), "default": Bool(true)}, "testUnion": Object {"type": String("boolean"), "description": String("Test for UNION-based SQL injection"), "default": Bool(true)}, "dbType": Object {"type": String("string"), "enum": Array [String("auto"), String("mysql"), String("postgresql"), String("mssql"), String("oracle"), String("sqlite")], "description": String("Target database type (auto for detection)"), "default": String("auto")}, "customPayloads": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Custom SQL injection payloads to test")}, "dictionaryId": Object {"type": String("string"), "description": String("Dictionary ID or name for SQLi payloads")}, "timeThreshold": Object {"type": String("integer"), "description": String("Time threshold in ms for time-based detection"), "default": Number(5000), "minimum": Number(3000), "maximum": Number(30000)}}}
DEBUG sentinel_ai_lib: 579: Plugin port_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of hosts/IPs to scan for port changes")}, "ports": Object {"type": String("array"), "items": Object {"type": String("integer")}, "description": String("Specific ports to scan (default: common ports)")}, "timeout": Object {"type": String("integer"), "description": String("Connection timeout in milliseconds per port"), "default": Number(3000), "minimum": Number(1000), "maximum": Number(30000)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent port checks"), "default": Number(10), "minimum": Number(1), "maximum": Number(50)}, "detectService": Object {"type": String("boolean"), "description": String("Try to detect service on open ports"), "default": Bool(true)}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous port snapshots for comparison")}}}
DEBUG sentinel_ai_lib: 579: Plugin js_link_finder input_schema: Object {"type": String("object"), "properties": Object {"url": Object {"type": String("string"), "description": String("Single target URL (use 'urls' for multiple targets)")}, "urls": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Array of target URLs to find JavaScript files from (supports batch processing)")}, "timeout": Object {"type": String("number"), "description": String("Request timeout in milliseconds (default: 15000)")}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "recursive": Object {"type": String("boolean"), "description": String("Recursively crawl same-origin pages to find more JS (default: false)")}, "maxDepth": Object {"type": String("number"), "description": String("Maximum crawl depth when recursive is enabled (default: 2)")}, "maxFiles": Object {"type": String("number"), "description": String("Maximum JS files to collect per URL (default: 100)")}, "includeSameOriginOnly": Object {"type": String("boolean"), "description": String("Only include JS files from the same origin (default: false)")}, "includeInline": Object {"type": String("boolean"), "description": String("Include inline <script> content hashes (default: true)")}, "followSourceMaps": Object {"type": String("boolean"), "description": String("Follow sourceMappingURL to find source maps (default: true)")}, "probeSpaManifests": Object {"type": String("boolean"), "description": String("Probe common SPA manifest endpoints (default: true)")}, "concurrency": Object {"type": String("number"), "description": String("Number of concurrent requests (default: 100)")}}}
DEBUG sentinel_ai_lib: 579: Plugin http_prober input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of targets to probe (domains, IPs, or URLs)")}, "ports": Object {"type": String("array"), "items": Object {"type": String("integer")}, "description": String("Ports to probe. Default: 80, 443, 8080, 8443"), "default": Array [Number(80), Number(443), Number(8080), Number(8443)]}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(10000), "minimum": Number(1000), "maximum": Number(60000)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests"), "default": Number(10), "minimum": Number(1), "maximum": Number(50)}, "followRedirects": Object {"type": String("boolean"), "description": String("Follow HTTP redirects"), "default": Bool(true)}, "maxRedirects": Object {"type": String("integer"), "description": String("Maximum number of redirects to follow"), "default": Number(5)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header"), "default": String("Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36")}, "extractTitle": Object {"type": String("boolean"), "description": String("Extract page title from HTML"), "default": Bool(true)}, "extractHeaders": Object {"type": String("boolean"), "description": String("Include response headers in results"), "default": Bool(false)}, "checkHttps": Object {"type": String("boolean"), "description": String("Check HTTPS protocol"), "default": Bool(true)}, "checkHttp": Object {"type": String("boolean"), "description": String("Check HTTP protocol"), "default": Bool(true)}}}
DEBUG sentinel_ai_lib: 579: Plugin js_analyzer input_schema: Object {"type": String("object"), "properties": Object {"url": Object {"type": String("string"), "description": String("Single target URL (HTML page or JavaScript file, use 'urls' for multiple targets)")}, "urls": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Array of target URLs to analyze (supports batch processing)")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "maxFileSize": Object {"type": String("integer"), "description": String("Maximum file size to analyze in bytes"), "default": Number(5242880), "minimum": Number(102400), "maximum": Number(52428800)}, "extractEndpoints": Object {"type": String("boolean"), "description": String("Extract API endpoints"), "default": Bool(true)}, "extractSecrets": Object {"type": String("boolean"), "description": String("Extract secrets and sensitive data"), "default": Bool(true)}, "extractDomains": Object {"type": String("boolean"), "description": String("Extract referenced domains"), "default": Bool(true)}, "followImports": Object {"type": String("boolean"), "description": String("Follow and analyze imported JS files"), "default": Bool(true)}, "maxFiles": Object {"type": String("integer"), "description": String("Maximum number of JS files to analyze per URL"), "default": Number(20), "minimum": Number(1), "maximum": Number(100)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests (default: 100)"), "default": Number(100), "minimum": Number(1), "maximum": Number(200)}}}
DEBUG sentinel_ai_lib: 579: Plugin subdomain_enumerator input_schema: Object {"type": String("object"), "required": Array [String("domain")], "properties": Object {"domain": Object {"type": String("string"), "description": String("Target domain to enumerate subdomains for (e.g., 'example.com')")}, "sources": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Data sources to query. Available: crtsh, certspotter, censys, google_ct, myssl, racent, hackertarget, rapiddns, anubis, dnsdumpster, sublist3r, bevigil, binaryedge, cebaidu, chinaz, chinaz_api, circl, cloudflare, dnsdb, dnsgrep, fullhunt, ip138, ipv4info, netcraft, passivedns, qianxun, riddler, robtex, securitytrails, sitedossier, spyse, windvane, alienvault, virustotal, virustotal_api, riskiq, threatbook, threatminer, urlscan, bing_api, fofa, gitee, github, google_api, hunter, quake, shodan, zoomeye, cdx, archive. Default: all sources"), "default": Array [String("crtsh"), String("certspotter"), String("censys"), String("google_ct"), String("myssl"), String("racent"), String("hackertarget"), String("rapiddns"), String("anubis"), String("dnsdumpster"), String("sublist3r"), String("bevigil"), String("binaryedge"), String("cebaidu"), String("chinaz"), String("chinaz_api"), String("circl"), String("cloudflare"), String("dnsdb"), String("dnsgrep"), String("fullhunt"), String("ip138"), String("ipv4info"), String("netcraft"), String("passivedns"), String("qianxun"), String("riddler"), String("robtex"), String("securitytrails"), String("sitedossier"), String("spyse"), String("windvane"), String("alienvault"), String("virustotal"), String("virustotal_api"), String("riskiq"), String("threatbook"), String("threatminer"), String("urlscan"), String("bing_api"), String("fofa"), String("gitee"), String("github"), String("google_api"), String("hunter"), String("quake"), String("shodan"), String("zoomeye"), String("cdx"), String("archive")]}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests"), "default": Number(5), "minimum": Number(1), "maximum": Number(10)}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(30000), "minimum": Number(5000), "maximum": Number(120000)}, "removeDuplicates": Object {"type": String("boolean"), "description": String("Remove duplicate subdomains from results"), "default": Bool(true)}, "apiConfig": Object {"type": String("object"), "description": String("API keys and credentials for various data sources"), "properties": Object {"censys_id": Object {"type": String("string"), "description": String("Censys API ID")}, "censys_secret": Object {"type": String("string"), "description": String("Censys API Secret")}, "racent_token": Object {"type": String("string"), "description": String("Racent API token")}, "bevigil_token": Object {"type": String("string"), "description": String("BeVigil API token")}, "binaryedge_token": Object {"type": String("string"), "description": String("BinaryEdge API token")}, "chinaz_token": Object {"type": String("string"), "description": String("Chinaz API key")}, "circl_user": Object {"type": String("string"), "description": String("CIRCL username")}, "circl_pass": Object {"type": String("string"), "description": String("CIRCL password")}, "cloudflare_token": Object {"type": String("string"), "description": String("Cloudflare API token")}, "dnsdb_token": Object {"type": String("string"), "description": String("DNSDB API key")}, "fullhunt_token": Object {"type": String("string"), "description": String("FullHunt API token")}, "ipv4info_token": Object {"type": String("string"), "description": String("IPv4Info API key")}, "passivedns_token": Object {"type": String("string"), "description": String("PassiveDNS API token")}, "passivedns_addr": Object {"type": String("string"), "description": String("PassiveDNS API address")}, "securitytrails_token": Object {"type": String("string"), "description": String("SecurityTrails API token")}, "spyse_token": Object {"type": String("string"), "description": String("Spyse API token")}, "windvane_token": Object {"type": String("string"), "description": String("Windvane API token")}, "riskiq_user": Object {"type": String("string"), "description": String("RiskIQ username")}, "riskiq_key": Object {"type": String("string"), "description": String("RiskIQ API key")}, "threatbook_token": Object {"type": String("string"), "description": String("ThreatBook API token")}, "virustotal_token": Object {"type": String("string"), "description": String("VirusTotal API token")}, "bing_token": Object {"type": String("string"), "description": String("Bing API key")}, "fofa_email": Object {"type": String("string"), "description": String("FOFA email")}, "fofa_key": Object {"type": String("string"), "description": String("FOFA API key")}, "github_token": Object {"type": String("string"), "description": String("GitHub API token")}, "google_key": Object {"type": String("string"), "description": String("Google API key")}, "google_cx": Object {"type": String("string"), "description": String("Google Custom Search Engine ID")}, "hunter_token": Object {"type": String("string"), "description": String("Hunter API token")}, "quake_token": Object {"type": String("string"), "description": String("Quake API token")}, "shodan_token": Object {"type": String("string"), "description": String("Shodan API token")}, "zoomeye_token": Object {"type": String("string"), "description": String("ZoomEye API token")}}}}}
DEBUG sentinel_ai_lib: 579: Plugin content_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of URLs to monitor for content changes")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "includeHeaders": Object {"type": String("boolean"), "description": String("Include response headers in snapshot"), "default": Bool(false)}, "excludePatterns": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Regex patterns to exclude from content hash (e.g., timestamps)")}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous content snapshots for comparison")}}}
 INFO sentinel_ai_lib: 592: Loading 9 plugin tools...
 INFO sentinel_ai_lib::commands::mcp_commands: 386: Auto-connecting MCP servers...
 INFO sentinel_ai_lib::commands::mcp_commands: 536: Auto-connect MCP servers completed
 INFO sentinel_ai_lib::commands::ai: 2190: Using tool config from frontend request
 INFO sentinel_ai_lib::commands::ai: 2196: Agent execute: conv=4f5f6887-9cda-4db1-bace-54e4a7dac160, msg=d07b97d7-5389-44dd-8171-f600c3e41e0a, rag=false, tools=true
 INFO sentinel_ai_lib::commands::ai: 2210: Using default chat model: moonshot/kimi-k2.5
 INFO sentinel_ai_lib::commands::ai: 2241: Setting output storage threshold to 10000 bytes (Dynamic Context Discovery)
 INFO sentinel_ai_lib::commands::ai: 2394: Using role prompt: 123
 INFO sentinel_ai_lib::commands::ai: 2537: Using tool-enabled agent executor for conversation: 4f5f6887-9cda-4db1-bace-54e4a7dac160
 INFO sentinel_ai_lib::agents::executor: 58: Executing agent - rig_provider: moonshot, model: kimi-k2.5, execution_id: 4f5f6887-9cda-4db1-bace-54e4a7dac160, tools_enabled: true, recursion_depth: 0
 INFO sentinel_ai_lib::agents::executor: 122: Tenth Man initialized for execution_id: 4f5f6887-9cda-4db1-bace-54e4a7dac160 (rule_enabled: false)
 INFO sentinel_ai_lib::agents::executor: 131: Refreshing MCP tools before execution...
 INFO sentinel_ai_lib::agents::executor: 184: Registered WebExplorerTool
 INFO sentinel_ai_lib::agents::executor: 194: ToolServer has 41 registered tools: ["web_explorer", "browser_close", "skills", "local_time", "subdomain_brute", "browser_select", "plugin__http_prober", "plugin__subdomain_enumerator", "tenth_man_review", "browser_wait", "plugin__sql_injection_scanner", "browser_snapshot", "browser_scroll", "browser_click", "plugin__js_link_finder", "plugin__api_monitor", "interactive_shell", "port_scan", "plugin__port_monitor", "browser_fill", "subagent_run", "browser_type", "browser_back", "browser_hover", "browser_press", "browser_evaluate", "plugin__js_analyzer", "ocr", "subagent_wait", "http_request", "browser_get_url", "subagent_spawn", "web_search", "browser_get_text", "plugin__content_monitor", "browser_screenshot", "todos", "memory_manager", "plugin__cert_monitor", "shell", "browser_open"]
 INFO sentinel_ai_lib::agents::tool_router: 1102: Loaded 0 workflow tools (is_tool=true)
 INFO sentinel_ai_lib::agents::tool_router: 1336: Loaded 9 plugin tools from database
 INFO sentinel_ai_lib::agents::tool_router: 1284: Loaded 0 MCP tools
 INFO sentinel_ai_lib::agents::executor::run_with_tools: 63: Selected 1 tools for execution_id 4f5f6887-9cda-4db1-bace-54e4a7dac160: ["http_request"]
 INFO sentinel_ai_lib::agents::context_engineering::builder: 175: Injected working directory into system prompt: /workspace/context
 INFO sentinel_ai_lib::agents::context_engineering::builder: 257: Conversation history exported to container: /workspace/context/history_4f5f6887-9cd.txt
 INFO sentinel_ai_lib::agents::context_engineering::builder: 361: Context usage - execution_id: 4f5f6887-9cda-4db1-bace-54e4a7dac160, system: 738, history: 22, summary: 0, used: 760, max: 128000
 INFO sentinel_ai_lib::agents::executor::run_with_tools: 230: Got 1 dynamic tool instances for rig-core native tool calling
 INFO sentinel_llm::streaming: 163: StreamingLlmClient - Provider: moonshot, Model: kimi-k2.5, Tools: ["http_request"], History: 0 messages
 INFO sentinel_llm::streaming: 246: Unknown provider 'moonshot', trying OpenAI compatible mode (via Generic Client)
 INFO sentinel_llm::streaming: 649: Adding dynamic tool to agent: http_request
 INFO sentinel_llm::streaming: 670: Starting stream iteration...
 INFO sentinel_llm::streaming: 674: Using max_turns: 200
 INFO sentinel_llm::streaming: 678: Final chat_history has 0 messages
 INFO sentinel_llm::streaming: 681: Using stream_prompt for empty chat history
 INFO sentinel_traffic::scanner: 888: Found x-sentinel-internal header with value: true
 INFO sentinel_traffic::proxy: 1905: Streaming response detected: request_id=5ded38d1-dfcf-42f6-8605-749ee598acf7, status=200 OK, conn_key=127.0.0.1:55469
TRACE rig::providers::deepseek: 773: SSE connection opened
 INFO sentinel_traffic::scanner: 888: Found x-sentinel-internal header with value: true
DEBUG rig::providers::deepseek: 784: Couldn't parse SSE payload as StreamingCompletionChunk: Error("missing field `prompt_cache_hit_tokens`", line: 1, column: 220)
 INFO sentinel_llm::streaming: 739: Tool call received: id=http_request:0, name=http_request, args={"url":"http://worldtimeapi.org/api/ip"}
DEBUG sentinel_ai_lib::agents::executor::run_with_tools: 402: Tool call complete via rig-core: http_request (http_request:0)
DEBUG rig: 494: Calling tool http_request with args:
"{\"url\":\"http://worldtimeapi.org/api/ip\"}"
 INFO sentinel_traffic::scanner: 888: Found x-sentinel-internal header with value: true
 INFO sentinel_ai_lib: 219: Debug mode: license check skipped
 INFO sentinel_ai_lib: 237: Loaded database config from file: "/Users/a1024/Library/Application Support/sentinel-ai/db_config.json"
 INFO sentinel_ai_lib: 275: Dictionary pool initialized for plugins
 INFO sentinel_ai_lib::commands::tool_commands::agent_config: 220: Agent configuration initialized from database
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::commands::rag_commands: 124: 数据库中未找到RAG配置，使用默认配置
 INFO sentinel_ai_lib::commands::rag_commands: 148: 从 AI 配置中获取嵌入服务地址: http://localhost:11434
 INFO sentinel_rag::service: 31: 初始化RAG服务 (使用 Rig + LanceDB)
 INFO sentinel_rag::service: 66: RAG服务使用LanceDB路径: /Users/a1024/Library/Application Support/sentinel-ai/AppData/lancedb
 INFO sentinel_rag::database: 40: LanceDB connected at: /Users/a1024/Library/Application Support/sentinel-ai/AppData/lancedb
 INFO sentinel_rag::service: 121: 默认RAG集合已存在
 INFO sentinel_rag::database: 44: Collection will be created on first insert
 INFO sentinel_ai_lib::commands::rag_commands: 189: Global RAG service initialized successfully
 INFO sentinel_ai_lib::commands::rag_commands: 1153: Ensuring memory collection exists
 INFO sentinel_rag::service: 1155: 获取RAG状态
 INFO sentinel_ai_lib::commands::rag_commands: 1163: Memory collection already exists: 5deac8e3-7cee-480d-accd-0653a0073328
 INFO sentinel_ai_lib: 296: Memory collection ready: 5deac8e3-7cee-480d-accd-0653a0073328
 INFO sentinel_traffic::history_cache: 253: Creating ProxyHistoryCache with max_http=5000, max_ws_conn=500, max_msg_per_conn=2000, retention=3600s, auto_persist=true
DEBUG sentinel_ai_lib::services::ai_manager: 343: Initializing default AI services...
DEBUG sentinel_ai_lib::services::ai_manager: 355: Successfully parsed 'providers_config' from DB.
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: Anthropic
 WARN sentinel_ai_lib::services::ai_manager: 393: Provider Anthropic has no default model configured, service may not work properly
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider Anthropic using rig_provider: anthropic, model: 
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: Moonshot
DEBUG sentinel_ai_lib::services::ai_manager: 383: Using global default model for Moonshot: kimi-k2.5
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider Moonshot using rig_provider: moonshot, model: kimi-k2.5
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: DeepSeek
 WARN sentinel_ai_lib::services::ai_manager: 393: Provider DeepSeek has no default model configured, service may not work properly
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider DeepSeek using rig_provider: deepseek, model: 
 INFO sentinel_ai_lib::services::ai_manager: 557: Default service alias now points to 'moonshot'
DEBUG sentinel_ai_lib::services::ai_manager: 489: Finished initializing AI services. Total: 4
 INFO sentinel_ai_lib::agents::tenth_man_executor: 330: Tenth Man executor initialized
 INFO sentinel_ai_lib: 480: Tenth Man executor initialized
 INFO sentinel_ai_lib::agents::subagent_executor: 790: Subagent executors initialized (spawn/wait/run)
 INFO sentinel_ai_lib: 485: Subagent executor initialized
 INFO sentinel_ai_lib::trackers::tool_execution_tracker: 185: Tool execution tracker initialized
 INFO sentinel_ai_lib: 489: Tool execution tracker initialized
 INFO sentinel_ai_lib::commands::tool_commands::shell_permissions: 114: Shell config loaded from database on startup
 INFO sentinel_ai_lib: 496: Workflow engine and scheduler initialized
 INFO sentinel_ai_lib::commands::cache_commands: 113: Cleaned up 0 expired cache entries
 INFO sentinel_ai_lib::commands::plugin_review_commands: 273: Getting plugin statistics
 INFO sentinel_ai_lib::commands::tool_commands::shell_permissions: 114: Shell config loaded from database on startup
 INFO sentinel_ai_lib::commands::plugin_review_commands: 478: Getting plugin review statistics
 INFO sentinel_rag::service: 1155: 获取RAG状态
 INFO sentinel_ai_lib: 513: Starting agent-browser daemon...
 INFO sentinel_ai_lib: 517: Agent-browser daemon started successfully
 INFO sentinel_ai_lib::commands::ai: 2646: Loaded global tool config from database
 INFO sentinel_ai_lib: 1322: Checking if proxy auto-start is enabled...
 INFO sentinel_ai_lib: 1361: No saved proxy configuration found, using default
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 446: No saved intercept filter rules found
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 475: Loaded 0 request filter rules
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 480: Loaded 0 response filter rules
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 491: Loaded traffic analysis plugin scanning enabled: true
 INFO sentinel_traffic::scanner: 645: Loading enabled plugins from database...
 INFO sentinel_traffic::proxy: 2551: Proxy bound to port 8080
 INFO sentinel_traffic::certificate: 141: Root CA already exists at /Users/a1024/Library/Application Support/sentinel-ai/ca/root-ca.pem
 INFO sentinel_traffic::scanner: 728: Loaded 0 enabled plugins from database
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 556: Loaded 0 enabled plugins into ScanPipeline
 INFO sentinel_traffic::scanner: 123: ScanPipeline started
 INFO sentinel_traffic::scanner: 1333: FindingDeduplicator started
 WARN sentinel_traffic::proxy: 2574: Root CA not trusted in macOS System keychain. Attempting to add trust...
 WARN sentinel_traffic::proxy: 2578: Auto trust failed: 证书错误: Failed to trust CA: SecCertificateAddToKeychain: Write permissions error.
. You may need to import /Users/a1024/Library/Application Support/sentinel-ai/ca/root-ca.pem into System keychain and set to 'Always Trust'.
 INFO sentinel_traffic::proxy: 2629: Checking upstream proxy config: None
 INFO sentinel_traffic::proxy: 2646: Use upstream proxy decision: false
 INFO sentinel_traffic::proxy: 2701: Starting HTTPS MITM proxy on port 8080 (ignoring upstream cert errors)
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 836: Traffic scan started on port 8080 (ScanPipeline running in dedicated thread)
 INFO sentinel_ai_lib: 1373: ✅ Proxy listener auto-started successfully on port 8080
 INFO sentinel_ai_lib: 526: Starting delayed MCP server auto-connect...
DEBUG sentinel_ai_lib: 579: Plugin cert_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of domains or URLs to monitor certificates")}, "timeout": Object {"type": String("integer"), "description": String("Connection timeout in milliseconds"), "default": Number(10000), "minimum": Number(5000), "maximum": Number(60000)}, "checkExpiry": Object {"type": String("boolean"), "description": String("Check certificate expiry dates"), "default": Bool(true)}, "expiryWarningDays": Object {"type": String("integer"), "description": String("Days before expiry to generate warning"), "default": Number(30), "minimum": Number(1), "maximum": Number(365)}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous certificate snapshots for comparison"), "additionalProperties": Object {"type": String("object"), "properties": Object {"domain": Object {"type": String("string")}, "fingerprint": Object {"type": String("string")}, "validTo": Object {"type": String("string")}, "issuer": Object {"type": String("string")}, "lastChecked": Object {"type": String("string")}}}}}}
DEBUG sentinel_ai_lib: 579: Plugin api_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of base URLs to monitor for API changes")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "crawlDepth": Object {"type": String("integer"), "description": String("Depth to crawl for JS files"), "default": Number(1), "minimum": Number(0), "maximum": Number(3)}, "includeGraphQL": Object {"type": String("boolean"), "description": String("Check for GraphQL endpoints"), "default": Bool(true)}, "includeOpenAPI": Object {"type": String("boolean"), "description": String("Check for OpenAPI/Swagger specs"), "default": Bool(true)}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous API snapshots for comparison")}}}
DEBUG sentinel_ai_lib: 579: Plugin sql_injection_scanner input_schema: Object {"type": String("object"), "required": Array [String("url")], "properties": Object {"url": Object {"type": String("string"), "description": String("Target URL to test for SQL injection vulnerabilities")}, "method": Object {"type": String("string"), "enum": Array [String("GET"), String("POST"), String("PUT"), String("PATCH")], "description": String("HTTP method to use"), "default": String("GET")}, "params": Object {"type": String("object"), "description": String("URL parameters to test (key-value pairs)"), "additionalProperties": Object {"type": String("string")}}, "headers": Object {"type": String("object"), "description": String("Custom headers to include"), "additionalProperties": Object {"type": String("string")}}, "body": Object {"type": String("string"), "description": String("Request body (for POST/PUT/PATCH)")}, "contentType": Object {"type": String("string"), "description": String("Content-Type header"), "default": String("application/x-www-form-urlencoded")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests"), "default": Number(3), "minimum": Number(1), "maximum": Number(10)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "testErrorBased": Object {"type": String("boolean"), "description": String("Test for error-based SQL injection"), "default": Bool(true)}, "testBlind": Object {"type": String("boolean"), "description": String("Test for blind boolean-based SQL injection"), "default": Bool(true)}, "testTimeBased": Object {"type": String("boolean"), "description": String("Test for time-based blind SQL injection"), "default": Bool(true)}, "testUnion": Object {"type": String("boolean"), "description": String("Test for UNION-based SQL injection"), "default": Bool(true)}, "dbType": Object {"type": String("string"), "enum": Array [String("auto"), String("mysql"), String("postgresql"), String("mssql"), String("oracle"), String("sqlite")], "description": String("Target database type (auto for detection)"), "default": String("auto")}, "customPayloads": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Custom SQL injection payloads to test")}, "dictionaryId": Object {"type": String("string"), "description": String("Dictionary ID or name for SQLi payloads")}, "timeThreshold": Object {"type": String("integer"), "description": String("Time threshold in ms for time-based detection"), "default": Number(5000), "minimum": Number(3000), "maximum": Number(30000)}}}
DEBUG sentinel_ai_lib: 579: Plugin port_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of hosts/IPs to scan for port changes")}, "ports": Object {"type": String("array"), "items": Object {"type": String("integer")}, "description": String("Specific ports to scan (default: common ports)")}, "timeout": Object {"type": String("integer"), "description": String("Connection timeout in milliseconds per port"), "default": Number(3000), "minimum": Number(1000), "maximum": Number(30000)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent port checks"), "default": Number(10), "minimum": Number(1), "maximum": Number(50)}, "detectService": Object {"type": String("boolean"), "description": String("Try to detect service on open ports"), "default": Bool(true)}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous port snapshots for comparison")}}}
DEBUG sentinel_ai_lib: 579: Plugin js_link_finder input_schema: Object {"type": String("object"), "properties": Object {"url": Object {"type": String("string"), "description": String("Single target URL (use 'urls' for multiple targets)")}, "urls": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Array of target URLs to find JavaScript files from (supports batch processing)")}, "timeout": Object {"type": String("number"), "description": String("Request timeout in milliseconds (default: 15000)")}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "recursive": Object {"type": String("boolean"), "description": String("Recursively crawl same-origin pages to find more JS (default: false)")}, "maxDepth": Object {"type": String("number"), "description": String("Maximum crawl depth when recursive is enabled (default: 2)")}, "maxFiles": Object {"type": String("number"), "description": String("Maximum JS files to collect per URL (default: 100)")}, "includeSameOriginOnly": Object {"type": String("boolean"), "description": String("Only include JS files from the same origin (default: false)")}, "includeInline": Object {"type": String("boolean"), "description": String("Include inline <script> content hashes (default: true)")}, "followSourceMaps": Object {"type": String("boolean"), "description": String("Follow sourceMappingURL to find source maps (default: true)")}, "probeSpaManifests": Object {"type": String("boolean"), "description": String("Probe common SPA manifest endpoints (default: true)")}, "concurrency": Object {"type": String("number"), "description": String("Number of concurrent requests (default: 100)")}}}
DEBUG sentinel_ai_lib: 579: Plugin http_prober input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of targets to probe (domains, IPs, or URLs)")}, "ports": Object {"type": String("array"), "items": Object {"type": String("integer")}, "description": String("Ports to probe. Default: 80, 443, 8080, 8443"), "default": Array [Number(80), Number(443), Number(8080), Number(8443)]}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(10000), "minimum": Number(1000), "maximum": Number(60000)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests"), "default": Number(10), "minimum": Number(1), "maximum": Number(50)}, "followRedirects": Object {"type": String("boolean"), "description": String("Follow HTTP redirects"), "default": Bool(true)}, "maxRedirects": Object {"type": String("integer"), "description": String("Maximum number of redirects to follow"), "default": Number(5)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header"), "default": String("Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36")}, "extractTitle": Object {"type": String("boolean"), "description": String("Extract page title from HTML"), "default": Bool(true)}, "extractHeaders": Object {"type": String("boolean"), "description": String("Include response headers in results"), "default": Bool(false)}, "checkHttps": Object {"type": String("boolean"), "description": String("Check HTTPS protocol"), "default": Bool(true)}, "checkHttp": Object {"type": String("boolean"), "description": String("Check HTTP protocol"), "default": Bool(true)}}}
DEBUG sentinel_ai_lib: 579: Plugin js_analyzer input_schema: Object {"type": String("object"), "properties": Object {"url": Object {"type": String("string"), "description": String("Single target URL (HTML page or JavaScript file, use 'urls' for multiple targets)")}, "urls": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Array of target URLs to analyze (supports batch processing)")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "maxFileSize": Object {"type": String("integer"), "description": String("Maximum file size to analyze in bytes"), "default": Number(5242880), "minimum": Number(102400), "maximum": Number(52428800)}, "extractEndpoints": Object {"type": String("boolean"), "description": String("Extract API endpoints"), "default": Bool(true)}, "extractSecrets": Object {"type": String("boolean"), "description": String("Extract secrets and sensitive data"), "default": Bool(true)}, "extractDomains": Object {"type": String("boolean"), "description": String("Extract referenced domains"), "default": Bool(true)}, "followImports": Object {"type": String("boolean"), "description": String("Follow and analyze imported JS files"), "default": Bool(true)}, "maxFiles": Object {"type": String("integer"), "description": String("Maximum number of JS files to analyze per URL"), "default": Number(20), "minimum": Number(1), "maximum": Number(100)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests (default: 100)"), "default": Number(100), "minimum": Number(1), "maximum": Number(200)}}}
DEBUG sentinel_ai_lib: 579: Plugin subdomain_enumerator input_schema: Object {"type": String("object"), "required": Array [String("domain")], "properties": Object {"domain": Object {"type": String("string"), "description": String("Target domain to enumerate subdomains for (e.g., 'example.com')")}, "sources": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Data sources to query. Available: crtsh, certspotter, censys, google_ct, myssl, racent, hackertarget, rapiddns, anubis, dnsdumpster, sublist3r, bevigil, binaryedge, cebaidu, chinaz, chinaz_api, circl, cloudflare, dnsdb, dnsgrep, fullhunt, ip138, ipv4info, netcraft, passivedns, qianxun, riddler, robtex, securitytrails, sitedossier, spyse, windvane, alienvault, virustotal, virustotal_api, riskiq, threatbook, threatminer, urlscan, bing_api, fofa, gitee, github, google_api, hunter, quake, shodan, zoomeye, cdx, archive. Default: all sources"), "default": Array [String("crtsh"), String("certspotter"), String("censys"), String("google_ct"), String("myssl"), String("racent"), String("hackertarget"), String("rapiddns"), String("anubis"), String("dnsdumpster"), String("sublist3r"), String("bevigil"), String("binaryedge"), String("cebaidu"), String("chinaz"), String("chinaz_api"), String("circl"), String("cloudflare"), String("dnsdb"), String("dnsgrep"), String("fullhunt"), String("ip138"), String("ipv4info"), String("netcraft"), String("passivedns"), String("qianxun"), String("riddler"), String("robtex"), String("securitytrails"), String("sitedossier"), String("spyse"), String("windvane"), String("alienvault"), String("virustotal"), String("virustotal_api"), String("riskiq"), String("threatbook"), String("threatminer"), String("urlscan"), String("bing_api"), String("fofa"), String("gitee"), String("github"), String("google_api"), String("hunter"), String("quake"), String("shodan"), String("zoomeye"), String("cdx"), String("archive")]}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests"), "default": Number(5), "minimum": Number(1), "maximum": Number(10)}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(30000), "minimum": Number(5000), "maximum": Number(120000)}, "removeDuplicates": Object {"type": String("boolean"), "description": String("Remove duplicate subdomains from results"), "default": Bool(true)}, "apiConfig": Object {"type": String("object"), "description": String("API keys and credentials for various data sources"), "properties": Object {"censys_id": Object {"type": String("string"), "description": String("Censys API ID")}, "censys_secret": Object {"type": String("string"), "description": String("Censys API Secret")}, "racent_token": Object {"type": String("string"), "description": String("Racent API token")}, "bevigil_token": Object {"type": String("string"), "description": String("BeVigil API token")}, "binaryedge_token": Object {"type": String("string"), "description": String("BinaryEdge API token")}, "chinaz_token": Object {"type": String("string"), "description": String("Chinaz API key")}, "circl_user": Object {"type": String("string"), "description": String("CIRCL username")}, "circl_pass": Object {"type": String("string"), "description": String("CIRCL password")}, "cloudflare_token": Object {"type": String("string"), "description": String("Cloudflare API token")}, "dnsdb_token": Object {"type": String("string"), "description": String("DNSDB API key")}, "fullhunt_token": Object {"type": String("string"), "description": String("FullHunt API token")}, "ipv4info_token": Object {"type": String("string"), "description": String("IPv4Info API key")}, "passivedns_token": Object {"type": String("string"), "description": String("PassiveDNS API token")}, "passivedns_addr": Object {"type": String("string"), "description": String("PassiveDNS API address")}, "securitytrails_token": Object {"type": String("string"), "description": String("SecurityTrails API token")}, "spyse_token": Object {"type": String("string"), "description": String("Spyse API token")}, "windvane_token": Object {"type": String("string"), "description": String("Windvane API token")}, "riskiq_user": Object {"type": String("string"), "description": String("RiskIQ username")}, "riskiq_key": Object {"type": String("string"), "description": String("RiskIQ API key")}, "threatbook_token": Object {"type": String("string"), "description": String("ThreatBook API token")}, "virustotal_token": Object {"type": String("string"), "description": String("VirusTotal API token")}, "bing_token": Object {"type": String("string"), "description": String("Bing API key")}, "fofa_email": Object {"type": String("string"), "description": String("FOFA email")}, "fofa_key": Object {"type": String("string"), "description": String("FOFA API key")}, "github_token": Object {"type": String("string"), "description": String("GitHub API token")}, "google_key": Object {"type": String("string"), "description": String("Google API key")}, "google_cx": Object {"type": String("string"), "description": String("Google Custom Search Engine ID")}, "hunter_token": Object {"type": String("string"), "description": String("Hunter API token")}, "quake_token": Object {"type": String("string"), "description": String("Quake API token")}, "shodan_token": Object {"type": String("string"), "description": String("Shodan API token")}, "zoomeye_token": Object {"type": String("string"), "description": String("ZoomEye API token")}}}}}
DEBUG sentinel_ai_lib: 579: Plugin content_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of URLs to monitor for content changes")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "includeHeaders": Object {"type": String("boolean"), "description": String("Include response headers in snapshot"), "default": Bool(false)}, "excludePatterns": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Regex patterns to exclude from content hash (e.g., timestamps)")}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous content snapshots for comparison")}}}
 INFO sentinel_ai_lib: 592: Loading 9 plugin tools...
 INFO sentinel_ai_lib::commands::mcp_commands: 386: Auto-connecting MCP servers...
 INFO sentinel_ai_lib::commands::mcp_commands: 536: Auto-connect MCP servers completed
 INFO sentinel_ai_lib::commands::ai: 2190: Using tool config from frontend request
 INFO sentinel_ai_lib::commands::ai: 2196: Agent execute: conv=4f5f6887-9cda-4db1-bace-54e4a7dac160, msg=0615a31e-c954-4c2e-a414-bc168b1e5140, rag=false, tools=true
 INFO sentinel_ai_lib::commands::ai: 2210: Using default chat model: moonshot/kimi-k2.5
 INFO sentinel_ai_lib::commands::ai: 2241: Setting output storage threshold to 10000 bytes (Dynamic Context Discovery)
 INFO sentinel_ai_lib::commands::ai: 2394: Using role prompt: 123
 INFO sentinel_ai_lib::commands::ai: 2537: Using tool-enabled agent executor for conversation: 4f5f6887-9cda-4db1-bace-54e4a7dac160
 INFO sentinel_ai_lib::agents::executor: 58: Executing agent - rig_provider: moonshot, model: kimi-k2.5, execution_id: 4f5f6887-9cda-4db1-bace-54e4a7dac160, tools_enabled: true, recursion_depth: 0
 INFO sentinel_ai_lib::agents::executor: 122: Tenth Man initialized for execution_id: 4f5f6887-9cda-4db1-bace-54e4a7dac160 (rule_enabled: false)
 INFO sentinel_ai_lib::agents::executor: 131: Refreshing MCP tools before execution...
 INFO sentinel_ai_lib::agents::executor: 184: Registered WebExplorerTool
 INFO sentinel_ai_lib::agents::executor: 194: ToolServer has 41 registered tools: ["browser_type", "skills", "memory_manager", "subdomain_brute", "browser_select", "web_explorer", "browser_fill", "browser_press", "plugin__cert_monitor", "plugin__api_monitor", "plugin__port_monitor", "plugin__js_analyzer", "ocr", "shell", "subagent_run", "http_request", "interactive_shell", "browser_scroll", "browser_evaluate", "browser_close", "local_time", "subagent_wait", "web_search", "todos", "browser_get_text", "plugin__sql_injection_scanner", "port_scan", "plugin__subdomain_enumerator", "browser_click", "browser_get_url", "tenth_man_review", "browser_hover", "plugin__http_prober", "subagent_spawn", "browser_open", "browser_wait", "plugin__content_monitor", "browser_snapshot", "browser_screenshot", "browser_back", "plugin__js_link_finder"]
 INFO sentinel_ai_lib::agents::tool_router: 1102: Loaded 0 workflow tools (is_tool=true)
 INFO sentinel_ai_lib::agents::tool_router: 1336: Loaded 9 plugin tools from database
 INFO sentinel_ai_lib::agents::tool_router: 1284: Loaded 0 MCP tools
 INFO sentinel_ai_lib::agents::executor::run_with_tools: 63: Selected 1 tools for execution_id 4f5f6887-9cda-4db1-bace-54e4a7dac160: ["http_request"]
 INFO sentinel_ai_lib::agents::context_engineering::builder: 175: Injected working directory into system prompt: /workspace/context
 INFO sentinel_ai_lib::agents::context_engineering::builder: 257: Conversation history exported to container: /workspace/context/history_4f5f6887-9cd.txt
 INFO sentinel_ai_lib::agents::context_engineering::builder: 361: Context usage - execution_id: 4f5f6887-9cda-4db1-bace-54e4a7dac160, system: 738, history: 22, summary: 0, used: 760, max: 128000
 INFO sentinel_ai_lib::agents::executor::run_with_tools: 230: Got 1 dynamic tool instances for rig-core native tool calling
 INFO sentinel_llm::streaming: 163: StreamingLlmClient - Provider: moonshot, Model: kimi-k2.5, Tools: ["http_request"], History: 0 messages
 INFO sentinel_llm::streaming: 246: Unknown provider 'moonshot', trying OpenAI compatible mode (via Generic Client)
 INFO sentinel_llm::streaming: 649: Adding dynamic tool to agent: http_request
 INFO sentinel_llm::streaming: 670: Starting stream iteration...
 INFO sentinel_llm::streaming: 674: Using max_turns: 200
 INFO sentinel_llm::streaming: 678: Final chat_history has 0 messages
 INFO sentinel_llm::streaming: 681: Using stream_prompt for empty chat history
 INFO sentinel_traffic::scanner: 888: Found x-sentinel-internal header with value: true
 INFO sentinel_traffic::proxy: 1905: Streaming response detected: request_id=df4306e5-098d-4d3e-83f0-8844ae184fed, status=200 OK, conn_key=127.0.0.1:55542
TRACE rig::providers::deepseek: 773: SSE connection opened
 INFO sentinel_ai_lib: 219: Debug mode: license check skipped
 INFO sentinel_ai_lib: 237: Loaded database config from file: "/Users/a1024/Library/Application Support/sentinel-ai/db_config.json"
 INFO sentinel_ai_lib: 219: Debug mode: license check skipped
 INFO sentinel_ai_lib: 237: Loaded database config from file: "/Users/a1024/Library/Application Support/sentinel-ai/db_config.json"
 INFO sentinel_ai_lib: 275: Dictionary pool initialized for plugins
 INFO sentinel_ai_lib::commands::tool_commands::agent_config: 220: Agent configuration initialized from database
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::commands::rag_commands: 124: 数据库中未找到RAG配置，使用默认配置
 INFO sentinel_ai_lib::commands::rag_commands: 148: 从 AI 配置中获取嵌入服务地址: http://localhost:11434
 INFO sentinel_rag::service: 31: 初始化RAG服务 (使用 Rig + LanceDB)
 INFO sentinel_rag::service: 66: RAG服务使用LanceDB路径: /Users/a1024/Library/Application Support/sentinel-ai/AppData/lancedb
 INFO sentinel_rag::database: 40: LanceDB connected at: /Users/a1024/Library/Application Support/sentinel-ai/AppData/lancedb
 INFO sentinel_rag::service: 121: 默认RAG集合已存在
 INFO sentinel_rag::database: 44: Collection will be created on first insert
 INFO sentinel_ai_lib::commands::rag_commands: 189: Global RAG service initialized successfully
 INFO sentinel_ai_lib::commands::rag_commands: 1153: Ensuring memory collection exists
 INFO sentinel_rag::service: 1155: 获取RAG状态
 INFO sentinel_ai_lib::commands::rag_commands: 1163: Memory collection already exists: 5deac8e3-7cee-480d-accd-0653a0073328
 INFO sentinel_ai_lib: 296: Memory collection ready: 5deac8e3-7cee-480d-accd-0653a0073328
 INFO sentinel_traffic::history_cache: 253: Creating ProxyHistoryCache with max_http=5000, max_ws_conn=500, max_msg_per_conn=2000, retention=3600s, auto_persist=true
DEBUG sentinel_ai_lib::services::ai_manager: 343: Initializing default AI services...
DEBUG sentinel_ai_lib::services::ai_manager: 355: Successfully parsed 'providers_config' from DB.
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: DeepSeek
 WARN sentinel_ai_lib::services::ai_manager: 393: Provider DeepSeek has no default model configured, service may not work properly
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider DeepSeek using rig_provider: deepseek, model: 
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: Moonshot
DEBUG sentinel_ai_lib::services::ai_manager: 383: Using global default model for Moonshot: kimi-k2.5
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider Moonshot using rig_provider: moonshot, model: kimi-k2.5
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: Anthropic
 WARN sentinel_ai_lib::services::ai_manager: 393: Provider Anthropic has no default model configured, service may not work properly
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider Anthropic using rig_provider: anthropic, model: 
 INFO sentinel_ai_lib::services::ai_manager: 557: Default service alias now points to 'moonshot'
DEBUG sentinel_ai_lib::services::ai_manager: 489: Finished initializing AI services. Total: 4
 INFO sentinel_ai_lib::agents::tenth_man_executor: 330: Tenth Man executor initialized
 INFO sentinel_ai_lib: 480: Tenth Man executor initialized
 INFO sentinel_ai_lib::agents::subagent_executor: 790: Subagent executors initialized (spawn/wait/run)
 INFO sentinel_ai_lib: 485: Subagent executor initialized
 INFO sentinel_ai_lib::trackers::tool_execution_tracker: 185: Tool execution tracker initialized
 INFO sentinel_ai_lib: 489: Tool execution tracker initialized
 INFO sentinel_ai_lib::commands::tool_commands::shell_permissions: 114: Shell config loaded from database on startup
 INFO sentinel_ai_lib: 496: Workflow engine and scheduler initialized
 INFO sentinel_ai_lib: 219: Debug mode: license check skipped
 INFO sentinel_ai_lib: 237: Loaded database config from file: "/Users/a1024/Library/Application Support/sentinel-ai/db_config.json"
 INFO sentinel_ai_lib: 219: Debug mode: license check skipped
 INFO sentinel_ai_lib: 237: Loaded database config from file: "/Users/a1024/Library/Application Support/sentinel-ai/db_config.json"
 INFO sentinel_ai_lib: 219: Debug mode: license check skipped
 INFO sentinel_ai_lib: 237: Loaded database config from file: "/Users/a1024/Library/Application Support/sentinel-ai/db_config.json"
 INFO sentinel_ai_lib: 275: Dictionary pool initialized for plugins
 INFO sentinel_ai_lib::commands::tool_commands::agent_config: 220: Agent configuration initialized from database
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::commands::rag_commands: 124: 数据库中未找到RAG配置，使用默认配置
 INFO sentinel_ai_lib::commands::rag_commands: 148: 从 AI 配置中获取嵌入服务地址: http://localhost:11434
 INFO sentinel_rag::service: 31: 初始化RAG服务 (使用 Rig + LanceDB)
 INFO sentinel_rag::service: 66: RAG服务使用LanceDB路径: /Users/a1024/Library/Application Support/sentinel-ai/AppData/lancedb
 INFO sentinel_rag::database: 40: LanceDB connected at: /Users/a1024/Library/Application Support/sentinel-ai/AppData/lancedb
 INFO sentinel_rag::service: 121: 默认RAG集合已存在
 INFO sentinel_rag::database: 44: Collection will be created on first insert
 INFO sentinel_ai_lib::commands::rag_commands: 189: Global RAG service initialized successfully
 INFO sentinel_ai_lib::commands::rag_commands: 1153: Ensuring memory collection exists
 INFO sentinel_rag::service: 1155: 获取RAG状态
 INFO sentinel_ai_lib::commands::rag_commands: 1163: Memory collection already exists: 5deac8e3-7cee-480d-accd-0653a0073328
 INFO sentinel_ai_lib: 296: Memory collection ready: 5deac8e3-7cee-480d-accd-0653a0073328
 INFO sentinel_traffic::history_cache: 253: Creating ProxyHistoryCache with max_http=5000, max_ws_conn=500, max_msg_per_conn=2000, retention=3600s, auto_persist=true
DEBUG sentinel_ai_lib::services::ai_manager: 343: Initializing default AI services...
DEBUG sentinel_ai_lib::services::ai_manager: 355: Successfully parsed 'providers_config' from DB.
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: Anthropic
 WARN sentinel_ai_lib::services::ai_manager: 393: Provider Anthropic has no default model configured, service may not work properly
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider Anthropic using rig_provider: anthropic, model: 
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: DeepSeek
 WARN sentinel_ai_lib::services::ai_manager: 393: Provider DeepSeek has no default model configured, service may not work properly
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider DeepSeek using rig_provider: deepseek, model: 
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: Moonshot
DEBUG sentinel_ai_lib::services::ai_manager: 383: Using global default model for Moonshot: kimi-k2.5
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider Moonshot using rig_provider: moonshot, model: kimi-k2.5
 INFO sentinel_ai_lib::services::ai_manager: 557: Default service alias now points to 'moonshot'
DEBUG sentinel_ai_lib::services::ai_manager: 489: Finished initializing AI services. Total: 4
 INFO sentinel_ai_lib::agents::tenth_man_executor: 330: Tenth Man executor initialized
 INFO sentinel_ai_lib: 480: Tenth Man executor initialized
 INFO sentinel_ai_lib::agents::subagent_executor: 790: Subagent executors initialized (spawn/wait/run)
 INFO sentinel_ai_lib: 485: Subagent executor initialized
 INFO sentinel_ai_lib::trackers::tool_execution_tracker: 185: Tool execution tracker initialized
 INFO sentinel_ai_lib: 489: Tool execution tracker initialized
 INFO sentinel_ai_lib::commands::tool_commands::shell_permissions: 114: Shell config loaded from database on startup
 INFO sentinel_ai_lib: 496: Workflow engine and scheduler initialized
 INFO sentinel_ai_lib: 219: Debug mode: license check skipped
 INFO sentinel_ai_lib: 237: Loaded database config from file: "/Users/a1024/Library/Application Support/sentinel-ai/db_config.json"
 INFO sentinel_ai_lib: 275: Dictionary pool initialized for plugins
 INFO sentinel_ai_lib::commands::tool_commands::agent_config: 220: Agent configuration initialized from database
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::skills: 82: skills-ref not available, skipping validation: No such file or directory (os error 2)
 INFO sentinel_ai_lib::commands::rag_commands: 124: 数据库中未找到RAG配置，使用默认配置
 INFO sentinel_ai_lib::commands::rag_commands: 148: 从 AI 配置中获取嵌入服务地址: http://localhost:11434
 INFO sentinel_rag::service: 31: 初始化RAG服务 (使用 Rig + LanceDB)
 INFO sentinel_rag::service: 66: RAG服务使用LanceDB路径: /Users/a1024/Library/Application Support/sentinel-ai/AppData/lancedb
 INFO sentinel_rag::database: 40: LanceDB connected at: /Users/a1024/Library/Application Support/sentinel-ai/AppData/lancedb
 INFO sentinel_rag::service: 121: 默认RAG集合已存在
 INFO sentinel_rag::database: 44: Collection will be created on first insert
 INFO sentinel_ai_lib::commands::rag_commands: 189: Global RAG service initialized successfully
 INFO sentinel_ai_lib::commands::rag_commands: 1153: Ensuring memory collection exists
 INFO sentinel_rag::service: 1155: 获取RAG状态
 INFO sentinel_ai_lib::commands::rag_commands: 1163: Memory collection already exists: 5deac8e3-7cee-480d-accd-0653a0073328
 INFO sentinel_ai_lib: 296: Memory collection ready: 5deac8e3-7cee-480d-accd-0653a0073328
 INFO sentinel_traffic::history_cache: 253: Creating ProxyHistoryCache with max_http=5000, max_ws_conn=500, max_msg_per_conn=2000, retention=3600s, auto_persist=true
DEBUG sentinel_ai_lib::services::ai_manager: 343: Initializing default AI services...
DEBUG sentinel_ai_lib::services::ai_manager: 355: Successfully parsed 'providers_config' from DB.
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: Moonshot
DEBUG sentinel_ai_lib::services::ai_manager: 383: Using global default model for Moonshot: kimi-k2.5
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider Moonshot using rig_provider: moonshot, model: kimi-k2.5
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: DeepSeek
 WARN sentinel_ai_lib::services::ai_manager: 393: Provider DeepSeek has no default model configured, service may not work properly
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider DeepSeek using rig_provider: deepseek, model: 
DEBUG sentinel_ai_lib::services::ai_manager: 361: Initializing enabled provider: Anthropic
 WARN sentinel_ai_lib::services::ai_manager: 393: Provider Anthropic has no default model configured, service may not work properly
DEBUG sentinel_ai_lib::services::ai_manager: 408: Provider Anthropic using rig_provider: anthropic, model: 
 INFO sentinel_ai_lib::services::ai_manager: 557: Default service alias now points to 'moonshot'
DEBUG sentinel_ai_lib::services::ai_manager: 489: Finished initializing AI services. Total: 4
 INFO sentinel_ai_lib::agents::tenth_man_executor: 330: Tenth Man executor initialized
 INFO sentinel_ai_lib: 480: Tenth Man executor initialized
 INFO sentinel_ai_lib::agents::subagent_executor: 790: Subagent executors initialized (spawn/wait/run)
 INFO sentinel_ai_lib: 485: Subagent executor initialized
 INFO sentinel_ai_lib::trackers::tool_execution_tracker: 185: Tool execution tracker initialized
 INFO sentinel_ai_lib: 489: Tool execution tracker initialized
 INFO sentinel_ai_lib::commands::tool_commands::shell_permissions: 114: Shell config loaded from database on startup
 INFO sentinel_ai_lib: 496: Workflow engine and scheduler initialized
 INFO sentinel_ai_lib::commands::cache_commands: 113: Cleaned up 0 expired cache entries
 INFO sentinel_ai_lib::commands::plugin_review_commands: 273: Getting plugin statistics
 INFO sentinel_ai_lib::commands::tool_commands::shell_permissions: 114: Shell config loaded from database on startup
 INFO sentinel_ai_lib::commands::plugin_review_commands: 478: Getting plugin review statistics
 INFO sentinel_rag::service: 1155: 获取RAG状态
 INFO sentinel_ai_lib: 513: Starting agent-browser daemon...
 INFO sentinel_ai_lib: 517: Agent-browser daemon started successfully
 INFO sentinel_ai_lib::commands::ai: 2646: Loaded global tool config from database
 INFO sentinel_ai_lib: 1322: Checking if proxy auto-start is enabled...
 INFO sentinel_ai_lib: 1361: No saved proxy configuration found, using default
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 446: No saved intercept filter rules found
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 475: Loaded 0 request filter rules
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 480: Loaded 0 response filter rules
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 491: Loaded traffic analysis plugin scanning enabled: true
 INFO sentinel_traffic::proxy: 2551: Proxy bound to port 8080
 INFO sentinel_traffic::certificate: 141: Root CA already exists at /Users/a1024/Library/Application Support/sentinel-ai/ca/root-ca.pem
 INFO sentinel_traffic::scanner: 645: Loading enabled plugins from database...
 INFO sentinel_traffic::scanner: 728: Loaded 0 enabled plugins from database
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 556: Loaded 0 enabled plugins into ScanPipeline
 INFO sentinel_traffic::scanner: 123: ScanPipeline started
 INFO sentinel_traffic::scanner: 1333: FindingDeduplicator started
 WARN sentinel_traffic::proxy: 2574: Root CA not trusted in macOS System keychain. Attempting to add trust...
 WARN sentinel_traffic::proxy: 2578: Auto trust failed: 证书错误: Failed to trust CA: SecCertificateAddToKeychain: Write permissions error.
. You may need to import /Users/a1024/Library/Application Support/sentinel-ai/ca/root-ca.pem into System keychain and set to 'Always Trust'.
 INFO sentinel_traffic::proxy: 2629: Checking upstream proxy config: None
 INFO sentinel_traffic::proxy: 2646: Use upstream proxy decision: false
 INFO sentinel_traffic::proxy: 2701: Starting HTTPS MITM proxy on port 8080 (ignoring upstream cert errors)
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 836: Traffic scan started on port 8080 (ScanPipeline running in dedicated thread)
 INFO sentinel_ai_lib: 1373: ✅ Proxy listener auto-started successfully on port 8080
 INFO sentinel_ai_lib::commands::packet_capture_commands: 57: Getting network interfaces
 INFO sentinel_ai_lib::commands::proxifier_commands: 560: Loaded 0 proxies from database
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 3508: Getting proxy configuration
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 3529: No saved configuration found, using default
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 3508: Getting proxy configuration
 INFO sentinel_ai_lib::commands::traffic_analysis_commands: 3529: No saved configuration found, using default
 INFO sentinel_ai_lib::commands::proxifier_commands: 631: Loaded 0 rules from database
 INFO sentinel_ai_lib: 526: Starting delayed MCP server auto-connect...
DEBUG sentinel_ai_lib: 579: Plugin cert_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of domains or URLs to monitor certificates")}, "timeout": Object {"type": String("integer"), "description": String("Connection timeout in milliseconds"), "default": Number(10000), "minimum": Number(5000), "maximum": Number(60000)}, "checkExpiry": Object {"type": String("boolean"), "description": String("Check certificate expiry dates"), "default": Bool(true)}, "expiryWarningDays": Object {"type": String("integer"), "description": String("Days before expiry to generate warning"), "default": Number(30), "minimum": Number(1), "maximum": Number(365)}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous certificate snapshots for comparison"), "additionalProperties": Object {"type": String("object"), "properties": Object {"domain": Object {"type": String("string")}, "fingerprint": Object {"type": String("string")}, "validTo": Object {"type": String("string")}, "issuer": Object {"type": String("string")}, "lastChecked": Object {"type": String("string")}}}}}}
DEBUG sentinel_ai_lib: 579: Plugin api_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of base URLs to monitor for API changes")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "crawlDepth": Object {"type": String("integer"), "description": String("Depth to crawl for JS files"), "default": Number(1), "minimum": Number(0), "maximum": Number(3)}, "includeGraphQL": Object {"type": String("boolean"), "description": String("Check for GraphQL endpoints"), "default": Bool(true)}, "includeOpenAPI": Object {"type": String("boolean"), "description": String("Check for OpenAPI/Swagger specs"), "default": Bool(true)}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous API snapshots for comparison")}}}
DEBUG sentinel_ai_lib: 579: Plugin sql_injection_scanner input_schema: Object {"type": String("object"), "required": Array [String("url")], "properties": Object {"url": Object {"type": String("string"), "description": String("Target URL to test for SQL injection vulnerabilities")}, "method": Object {"type": String("string"), "enum": Array [String("GET"), String("POST"), String("PUT"), String("PATCH")], "description": String("HTTP method to use"), "default": String("GET")}, "params": Object {"type": String("object"), "description": String("URL parameters to test (key-value pairs)"), "additionalProperties": Object {"type": String("string")}}, "headers": Object {"type": String("object"), "description": String("Custom headers to include"), "additionalProperties": Object {"type": String("string")}}, "body": Object {"type": String("string"), "description": String("Request body (for POST/PUT/PATCH)")}, "contentType": Object {"type": String("string"), "description": String("Content-Type header"), "default": String("application/x-www-form-urlencoded")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests"), "default": Number(3), "minimum": Number(1), "maximum": Number(10)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "testErrorBased": Object {"type": String("boolean"), "description": String("Test for error-based SQL injection"), "default": Bool(true)}, "testBlind": Object {"type": String("boolean"), "description": String("Test for blind boolean-based SQL injection"), "default": Bool(true)}, "testTimeBased": Object {"type": String("boolean"), "description": String("Test for time-based blind SQL injection"), "default": Bool(true)}, "testUnion": Object {"type": String("boolean"), "description": String("Test for UNION-based SQL injection"), "default": Bool(true)}, "dbType": Object {"type": String("string"), "enum": Array [String("auto"), String("mysql"), String("postgresql"), String("mssql"), String("oracle"), String("sqlite")], "description": String("Target database type (auto for detection)"), "default": String("auto")}, "customPayloads": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Custom SQL injection payloads to test")}, "dictionaryId": Object {"type": String("string"), "description": String("Dictionary ID or name for SQLi payloads")}, "timeThreshold": Object {"type": String("integer"), "description": String("Time threshold in ms for time-based detection"), "default": Number(5000), "minimum": Number(3000), "maximum": Number(30000)}}}
DEBUG sentinel_ai_lib: 579: Plugin port_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of hosts/IPs to scan for port changes")}, "ports": Object {"type": String("array"), "items": Object {"type": String("integer")}, "description": String("Specific ports to scan (default: common ports)")}, "timeout": Object {"type": String("integer"), "description": String("Connection timeout in milliseconds per port"), "default": Number(3000), "minimum": Number(1000), "maximum": Number(30000)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent port checks"), "default": Number(10), "minimum": Number(1), "maximum": Number(50)}, "detectService": Object {"type": String("boolean"), "description": String("Try to detect service on open ports"), "default": Bool(true)}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous port snapshots for comparison")}}}
DEBUG sentinel_ai_lib: 579: Plugin js_link_finder input_schema: Object {"type": String("object"), "properties": Object {"url": Object {"type": String("string"), "description": String("Single target URL (use 'urls' for multiple targets)")}, "urls": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Array of target URLs to find JavaScript files from (supports batch processing)")}, "timeout": Object {"type": String("number"), "description": String("Request timeout in milliseconds (default: 15000)")}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "recursive": Object {"type": String("boolean"), "description": String("Recursively crawl same-origin pages to find more JS (default: false)")}, "maxDepth": Object {"type": String("number"), "description": String("Maximum crawl depth when recursive is enabled (default: 2)")}, "maxFiles": Object {"type": String("number"), "description": String("Maximum JS files to collect per URL (default: 100)")}, "includeSameOriginOnly": Object {"type": String("boolean"), "description": String("Only include JS files from the same origin (default: false)")}, "includeInline": Object {"type": String("boolean"), "description": String("Include inline <script> content hashes (default: true)")}, "followSourceMaps": Object {"type": String("boolean"), "description": String("Follow sourceMappingURL to find source maps (default: true)")}, "probeSpaManifests": Object {"type": String("boolean"), "description": String("Probe common SPA manifest endpoints (default: true)")}, "concurrency": Object {"type": String("number"), "description": String("Number of concurrent requests (default: 100)")}}}
DEBUG sentinel_ai_lib: 579: Plugin http_prober input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of targets to probe (domains, IPs, or URLs)")}, "ports": Object {"type": String("array"), "items": Object {"type": String("integer")}, "description": String("Ports to probe. Default: 80, 443, 8080, 8443"), "default": Array [Number(80), Number(443), Number(8080), Number(8443)]}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(10000), "minimum": Number(1000), "maximum": Number(60000)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests"), "default": Number(10), "minimum": Number(1), "maximum": Number(50)}, "followRedirects": Object {"type": String("boolean"), "description": String("Follow HTTP redirects"), "default": Bool(true)}, "maxRedirects": Object {"type": String("integer"), "description": String("Maximum number of redirects to follow"), "default": Number(5)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header"), "default": String("Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36")}, "extractTitle": Object {"type": String("boolean"), "description": String("Extract page title from HTML"), "default": Bool(true)}, "extractHeaders": Object {"type": String("boolean"), "description": String("Include response headers in results"), "default": Bool(false)}, "checkHttps": Object {"type": String("boolean"), "description": String("Check HTTPS protocol"), "default": Bool(true)}, "checkHttp": Object {"type": String("boolean"), "description": String("Check HTTP protocol"), "default": Bool(true)}}}
DEBUG sentinel_ai_lib: 579: Plugin js_analyzer input_schema: Object {"type": String("object"), "properties": Object {"url": Object {"type": String("string"), "description": String("Single target URL (HTML page or JavaScript file, use 'urls' for multiple targets)")}, "urls": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Array of target URLs to analyze (supports batch processing)")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "maxFileSize": Object {"type": String("integer"), "description": String("Maximum file size to analyze in bytes"), "default": Number(5242880), "minimum": Number(102400), "maximum": Number(52428800)}, "extractEndpoints": Object {"type": String("boolean"), "description": String("Extract API endpoints"), "default": Bool(true)}, "extractSecrets": Object {"type": String("boolean"), "description": String("Extract secrets and sensitive data"), "default": Bool(true)}, "extractDomains": Object {"type": String("boolean"), "description": String("Extract referenced domains"), "default": Bool(true)}, "followImports": Object {"type": String("boolean"), "description": String("Follow and analyze imported JS files"), "default": Bool(true)}, "maxFiles": Object {"type": String("integer"), "description": String("Maximum number of JS files to analyze per URL"), "default": Number(20), "minimum": Number(1), "maximum": Number(100)}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests (default: 100)"), "default": Number(100), "minimum": Number(1), "maximum": Number(200)}}}
DEBUG sentinel_ai_lib: 579: Plugin subdomain_enumerator input_schema: Object {"type": String("object"), "required": Array [String("domain")], "properties": Object {"domain": Object {"type": String("string"), "description": String("Target domain to enumerate subdomains for (e.g., 'example.com')")}, "sources": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Data sources to query. Available: crtsh, certspotter, censys, google_ct, myssl, racent, hackertarget, rapiddns, anubis, dnsdumpster, sublist3r, bevigil, binaryedge, cebaidu, chinaz, chinaz_api, circl, cloudflare, dnsdb, dnsgrep, fullhunt, ip138, ipv4info, netcraft, passivedns, qianxun, riddler, robtex, securitytrails, sitedossier, spyse, windvane, alienvault, virustotal, virustotal_api, riskiq, threatbook, threatminer, urlscan, bing_api, fofa, gitee, github, google_api, hunter, quake, shodan, zoomeye, cdx, archive. Default: all sources"), "default": Array [String("crtsh"), String("certspotter"), String("censys"), String("google_ct"), String("myssl"), String("racent"), String("hackertarget"), String("rapiddns"), String("anubis"), String("dnsdumpster"), String("sublist3r"), String("bevigil"), String("binaryedge"), String("cebaidu"), String("chinaz"), String("chinaz_api"), String("circl"), String("cloudflare"), String("dnsdb"), String("dnsgrep"), String("fullhunt"), String("ip138"), String("ipv4info"), String("netcraft"), String("passivedns"), String("qianxun"), String("riddler"), String("robtex"), String("securitytrails"), String("sitedossier"), String("spyse"), String("windvane"), String("alienvault"), String("virustotal"), String("virustotal_api"), String("riskiq"), String("threatbook"), String("threatminer"), String("urlscan"), String("bing_api"), String("fofa"), String("gitee"), String("github"), String("google_api"), String("hunter"), String("quake"), String("shodan"), String("zoomeye"), String("cdx"), String("archive")]}, "concurrency": Object {"type": String("integer"), "description": String("Number of concurrent requests"), "default": Number(5), "minimum": Number(1), "maximum": Number(10)}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(30000), "minimum": Number(5000), "maximum": Number(120000)}, "removeDuplicates": Object {"type": String("boolean"), "description": String("Remove duplicate subdomains from results"), "default": Bool(true)}, "apiConfig": Object {"type": String("object"), "description": String("API keys and credentials for various data sources"), "properties": Object {"censys_id": Object {"type": String("string"), "description": String("Censys API ID")}, "censys_secret": Object {"type": String("string"), "description": String("Censys API Secret")}, "racent_token": Object {"type": String("string"), "description": String("Racent API token")}, "bevigil_token": Object {"type": String("string"), "description": String("BeVigil API token")}, "binaryedge_token": Object {"type": String("string"), "description": String("BinaryEdge API token")}, "chinaz_token": Object {"type": String("string"), "description": String("Chinaz API key")}, "circl_user": Object {"type": String("string"), "description": String("CIRCL username")}, "circl_pass": Object {"type": String("string"), "description": String("CIRCL password")}, "cloudflare_token": Object {"type": String("string"), "description": String("Cloudflare API token")}, "dnsdb_token": Object {"type": String("string"), "description": String("DNSDB API key")}, "fullhunt_token": Object {"type": String("string"), "description": String("FullHunt API token")}, "ipv4info_token": Object {"type": String("string"), "description": String("IPv4Info API key")}, "passivedns_token": Object {"type": String("string"), "description": String("PassiveDNS API token")}, "passivedns_addr": Object {"type": String("string"), "description": String("PassiveDNS API address")}, "securitytrails_token": Object {"type": String("string"), "description": String("SecurityTrails API token")}, "spyse_token": Object {"type": String("string"), "description": String("Spyse API token")}, "windvane_token": Object {"type": String("string"), "description": String("Windvane API token")}, "riskiq_user": Object {"type": String("string"), "description": String("RiskIQ username")}, "riskiq_key": Object {"type": String("string"), "description": String("RiskIQ API key")}, "threatbook_token": Object {"type": String("string"), "description": String("ThreatBook API token")}, "virustotal_token": Object {"type": String("string"), "description": String("VirusTotal API token")}, "bing_token": Object {"type": String("string"), "description": String("Bing API key")}, "fofa_email": Object {"type": String("string"), "description": String("FOFA email")}, "fofa_key": Object {"type": String("string"), "description": String("FOFA API key")}, "github_token": Object {"type": String("string"), "description": String("GitHub API token")}, "google_key": Object {"type": String("string"), "description": String("Google API key")}, "google_cx": Object {"type": String("string"), "description": String("Google Custom Search Engine ID")}, "hunter_token": Object {"type": String("string"), "description": String("Hunter API token")}, "quake_token": Object {"type": String("string"), "description": String("Quake API token")}, "shodan_token": Object {"type": String("string"), "description": String("Shodan API token")}, "zoomeye_token": Object {"type": String("string"), "description": String("ZoomEye API token")}}}}}
DEBUG sentinel_ai_lib: 579: Plugin content_monitor input_schema: Object {"type": String("object"), "required": Array [String("targets")], "properties": Object {"targets": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("List of URLs to monitor for content changes")}, "timeout": Object {"type": String("integer"), "description": String("Request timeout in milliseconds"), "default": Number(15000), "minimum": Number(5000), "maximum": Number(60000)}, "userAgent": Object {"type": String("string"), "description": String("Custom User-Agent header")}, "includeHeaders": Object {"type": String("boolean"), "description": String("Include response headers in snapshot"), "default": Bool(false)}, "excludePatterns": Object {"type": String("array"), "items": Object {"type": String("string")}, "description": String("Regex patterns to exclude from content hash (e.g., timestamps)")}, "previousSnapshots": Object {"type": String("object"), "description": String("Previous content snapshots for comparison")}}}
 INFO sentinel_ai_lib: 592: Loading 9 plugin tools...
 INFO sentinel_ai_lib::commands::mcp_commands: 386: Auto-connecting MCP servers...
 INFO sentinel_ai_lib::commands::mcp_commands: 536: Auto-connect MCP servers completed
